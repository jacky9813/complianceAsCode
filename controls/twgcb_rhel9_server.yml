policy: Taiwan Goverment Configuration Baseline for Red Hat Enterprise Linux 9 Server'
title: Taiwan Goverment Configuration Baseline for Red Hat Enterprise Linux 9 Server'
id: twgcb_rhel9_server
version: '1.0'
source: https://download.nics.nat.gov.tw/UploadFile/attachfilegcb/TWGCB-01-012_Red%20Hat%20Enterprise%20Linux%209%E6%94%BF%E5%BA%9C%E7%B5%84%E6%85%8B%E5%9F%BA%E6%BA%96%E8%AA%AA%E6%98%8E%E6%96%87%E4%BB%B6(%E4%BC%BA%E6%9C%8D%E5%99%A8)v1.0_1121207.pdf
levels:
  - id: filesystem
  - id: system_config
  - id: services
  - id: softwares
  - id: networking
  - id: logging
  - id: selinux
  - id: cron
  - id: accounts
  - id: ssh
  - id: common
    inherits_from:
      - filesystem
      - system_config
      - services
      - softwares
      - networking
      - logging
      - selinux
      - cron
      - accounts
      - ssh
  - id: firewalld
    inherits_from:
      - common
  - id: nftables
    inherits_from:
      - common
product: rhel9
controls:
  - id: TWGCB-01-012-0001
    title: cramfs檔案系統
    levels:
      - filesystem
    notes: |-
      這項原則設定決定是否支援cramfs檔案系統
      cramfs (compressed ROM file system，壓縮唯讀閃存檔案系統)檔案系統是一開放式之Linux檔案系統，目的是更簡單更有效率
      cramfs檔案系統以zlib壓縮資料，不需載入到記憶體中，因此可節省許多記憶體空間，可直接使用cramfs映像檔案無須先解壓，使用於某些舊系統或對記憶體有限制之地方
      停止支援cramfs檔案系統，以減少系統被攻擊面
    status: automated
    rules:
      - kernel_module_cramfs_disabled
  - id: TWGCB-01-012-0002
    title: squashfs檔案系統
    levels:
      - filesystem
    notes: |-
      這項原則設定決定是否支援squashfs檔案系統
      squashfs是一個即時解壓縮之檔案系統，專門為唯讀壓縮檔案系統之使用而設計，常見於各Linux發行版之LiveCD
      停止支援squashfs檔案系統，以減少系統被攻擊面
      停止支援squashfs檔案系統，將可能導致Snap套件無法正常運作
    status: automated
    rules:
      - kernel_module_squashfs_disabled
  - id: TWGCB-01-012-0003
    title: udf檔案系統
    levels:
      - filesystem
    notes: |-
      這項原則設定決定是否支援udf檔案系統
      udf(Universal disk format，通用磁碟格式)是根據ISO/IEC 13346與ECMA-167標準所實作之檔案系統，由光學儲存技術協會(OSTA)開發與維護，廣泛應用在如CD-R/RW與DVD-R/RW等可寫光學儲存媒體
      停止支援udf檔案系統，以減少系統被攻擊面
      系統若運行在Microsot Azure上，將可能影響系統正常運作
    status: automated
    rules:
      - kernel_module_udf_disabled
  - id: TWGCB-01-012-0004
    title: 設定/tmp目錄之檔案系統
    levels:
      - filesystem
    notes: |-
      這項原則設定決定/tmp目錄是否使用tmpfs檔案系統
      /tmp是具有全域寫入權限之目錄，所有使用者與某些應用程式都將其用於暫存檔案
      tmpfs是一個不存在於實體硬碟上，而是駐存在記憶體之特殊檔案系統，可提供優於傳統機械硬碟之存取速度
      將/tmp目錄掛載到tmpfs，可於掛載選項上使用noexec選項，指定/tmp目錄不能啟動可執行二進制檔案，使攻擊者不能安裝執行惡意程式以降低風險
    status: automated
    rules:
      - partition_for_tmp
  - id: TWGCB-01-012-0005
    title: 設定/tmp目錄之nodev選項
    levels:
      - filesystem
    notes: |-
      這項原則設定決定/tmp目錄是否啟用nodev選項，以禁止在/tmp目錄中建立裝置檔案
      由於/tmp目錄用途不在於支援裝置，設定nodev選項以確保使用者無法在/tmp目錄建立裝置檔案或存取隨機硬體裝置，降低惡意程式感染風險
      可設定之參數如下：
      dev：允許建立裝置檔案
      nodev：禁止建立裝置檔案
    status: automated
    rules:
      - mount_option_tmp_nodev
  - id: TWGCB-01-012-0006
    title: 設定/tmp目錄之nosuid選項
    levels:
      - filesystem
    notes: |-
      這項原則設定決定/tmp目錄是否啟用nosuid選項，以禁止/tmp目錄存在具有SUID屬性之檔案
      SUID(Set User ID)是針對可執行二進制檔案(Binary file)設計之一項功能，任何使用者執行該程式時，會以該程式之擁有者身分執行，藉由短暫提權讓一般使用者存取未被授權之檔案
      可設定之參數如下：
      suid：允許存在具有SUID屬性之檔案
      nosuid：禁止存在具有SUID屬性之檔案
    status: automated
    rules:
      - mount_option_tmp_nosuid
  - id: TWGCB-01-012-0007
    title: 設定/tmp目錄之noexec選項
    levels:
      - filesystem
    notes: |-
      這項原則設定決定/tmp目錄是否啟用noexec選項，以禁止在/tmp目錄中啟動可執行二進制檔案
      /tmp目錄主要做為暫時存放檔案之用，禁止使用者啟動可執行二進制檔案，以避免感染惡意程式
      可設定之參數如下：
      exec：允許啟動可執行二進制檔案
      noexec：禁止啟動可執行二進制檔案
    status: automated
    rules:
      - mount_option_tmp_noexec
  - id: TWGCB-01-012-0008
    title: 設定/var目錄之檔案系統
    levels:
      - filesystem
    notes: |-
      這項原則設定決定是否為/var目錄建立獨立之分割磁區或邏輯磁區
      /var目錄主要供守護程序(daemon)與其他系統服務用來儲存經常性變動之資料
      /var目錄有時會包含其他軟體套件所建立之全域寫入目錄，若未設為獨立之分割磁區或邏輯磁區，將可能造成系統儲存空間耗盡
      由於yum套件管理工具或其他程式可能暫存較大之檔案於/var目錄中，可依實務需求設定適當磁區容量
    status: automated
    rules:
      - partition_for_var
  - id: TWGCB-01-012-0009
    title: 設定/var/tmp目錄之檔案系統
    levels:
      - filesystem
    notes: |-
      這項原則設定決定是否為/var/tmp目錄建立獨立之分割磁區或邏輯磁區
      /var/tmp是具有全域寫入權限之目錄，所有使用者與某些應用程式都將其用於暫存檔案，若未設為獨立之分割磁區或邏輯磁區，將可能造成系統儲存空間耗盡
      將/var/tmp目錄掛載到獨立之分割磁區或邏輯磁區，可於掛載選項上使用noexec選項，指定/var/tmp目錄不能啟動可執行二進制檔案，使攻擊者不能安裝執行惡意程式
    status: automated
    rules:
      - partition_for_var_tmp
  - id: TWGCB-01-012-0010
    title: 設定/var/tmp目錄之nodev選項
    levels:
      - filesystem
    notes: |-
      這項原則設定決定/var/tmp目錄是否啟用nodev選項，以禁止在/var/tmp目錄中建立裝置檔案
      由於/var/tmp目錄用途不在於支援裝置，設定nodev選項以確保使用者無法在/var/tmp目錄建立裝置檔案或存取隨機硬體裝置，降低惡意程式感染風險
      可設定之參數如下：
      dev：允許建立裝置檔案
      nodev：禁止建立裝置檔案
    status: automated
    rules:
      - mount_option_var_tmp_nodev
  - id: TWGCB-01-012-0011
    title: 設定/var/tmp目錄之nosuid選項
    levels:
      - filesystem
    notes: |-
      這項原則設定決定/var/tmp目錄是否啟用nosuid選項，以禁止/var/tmp目錄存在具有SUID屬性的檔案
      SUID(Set User ID)是針對可執行二進制檔案(Binary file)設計的一項功能，任何使用者執行該程式時，會以該程式之擁有者身分執行，藉由短暫提權讓一般使用者存取未被授權之檔案
      可設定之參數如下：
      suid：允許存在具有SUID屬性的檔案
      nosuid：禁止存在具有SUID屬性的檔案
    status: automated
    rules:
      - mount_option_var_tmp_nosuid
  - id: TWGCB-01-012-0012
    title: 設定/var/tmp目錄之noexec選項
    levels:
      - filesystem
    notes: |-
      這項原則設定決定/var/tmp目錄是否啟用noexec選項，以禁止在/var/tmp目錄中啟動可執行二進制檔案
      /var/tmp目錄主要做為暫時存放檔案之用，禁止使用者啟動可執行二進制檔案，以避免感染惡意程式
      可設定之參數如下：
      exec：允許啟動可執行二進制檔案
      noexec：禁止啟動可執行二進制檔案
    status: automated
    rules:
      - mount_option_var_tmp_noexec
  - id: TWGCB-01-012-0013
    title: 設定/var/log目錄之檔案系統
    levels:
      - filesystem
    notes: |-
      這項原則設定決定是否為/var/log目錄建立獨立之分割磁區或邏輯磁區
      /var/log目錄用來存放系統日誌(System log)，可依實務需求設定適當磁區容量，以確保所有系統日誌皆可順利儲存
      由於系統日誌檔容量可能會過於巨大，為/var/log目錄建立獨立之分割磁區或邏輯磁區，可避免系統儲存空間耗盡，同時可保護稽核紀錄
    status: automated
    rules:
      - partition_for_var_log
  - id: TWGCB-01-012-0014
    title: 設定/var/log/audit目錄之檔案系統
    levels:
      - filesystem
    notes: |-
      這項原則設定決定是否為/var/log/audit目錄建立獨立之分割磁區或邏輯磁區
      /var/log/audit目錄用來存放稽核日誌(Audit log)，可依實務需求設定適當磁區容量，以確保所有由auditd服務程序所產生之稽核日誌皆可順利儲存
      由於稽核日誌檔容量可能會過於巨大，為/var/log/audit目錄建立獨立之分割磁區或邏輯磁區，可避免系統儲存空間耗盡，同時可保護稽核紀錄
    status: automated
    rules:
      - partition_for_var_log_audit
  - id: TWGCB-01-012-0015
    title: 設定/home目錄之檔案系統
    levels:
      - filesystem
    notes: |-
      這項原則設定決定是否為/home目錄建立獨立之分割磁區或邏輯磁區
      /home目錄是系統預設之使用者家目錄(Home directory)。每當新增1個一般使用者帳號時，預設的使用者家目錄都會建立在/home目錄下
      為/home目錄建立獨立之分割磁區或邏輯磁區，可避免系統儲存空間耗盡，同時可限制欲存放的檔案類型
    status: automated
    rules:
      - partition_for_home
  - id: TWGCB-01-012-0016
    title: 設定/home目錄之nodev選項
    levels:
      - filesystem
    notes: |-
      這項原則設定決定/home目錄是否啟用nodev選項，以禁止在/home目錄中建立裝置檔案
      /home目錄是系統預設之使用者家目錄(Home directory)。每當新增一般使用者帳號時，預設之使用者家目錄都會建立在/home目錄下
      由於/home目錄用途不在於支援裝置，設定nodev選項以確保使用者無法在/home目錄建立裝置檔案或存取隨機硬體裝置，降低惡意程式感染風險
      可設定之參數如下：
      dev：允許建立裝置檔案
      nodev：禁止建立裝置檔案
    status: automated
    rules:
      - mount_option_home_nodev
  - id: TWGCB-01-012-0017
    title: 設定/dev/shm目錄之nodev選項
    levels:
      - filesystem
    notes: |-
      這項原則設定決定/dev/shm目錄是否啟用nodev選項，以禁止在/dev/shm目錄中建立裝置檔案
      /dev/shm目錄是系統利用記憶體建立之虛擬磁碟空間，用以存放暫存檔案，一方面存取速度比硬碟快，另一方面可依實際檔案大小動態分配空間
      由於/dev/shm目錄用途不在於支援裝置，設定nodev選項以確保使用者無法在/dev/shm目錄建立裝置檔案或存取隨機硬體裝置，降低惡意程式感染風險
      可設定之參數如下：
      dev：允許建立裝置檔案
      nodev：禁止建立裝置檔案
    status: automated
    rules:
      - mount_option_dev_shm_nodev
  - id: TWGCB-01-012-0018
    title: 設定/dev/shm目錄之nosuid選項
    levels:
      - filesystem
    notes: |-
      這項原則設定決定/dev/shm目錄是否啟用nosuid選項，以禁止/dev/shm目錄存在具有SUID屬性之檔案
      /dev/shm目錄是系統利用記憶體建立之虛擬磁碟空間，用以存放暫存檔案，一方面存取速度比硬碟快，另一方面可依實際檔案大小動態分配空間
      SUID(Set User ID)是針對可執行二進制檔案(Binary file)設計之一項功能，任何使用者執行該程式時，會以該程式之擁有者身分執行，藉由短暫提權讓一般使用者存取未被授權之檔案
      可設定之參數如下：
      suid：允許存在具有SUID屬性之檔案
      nosuid：禁止存在具有SUID屬性之檔案
    status: automated
    rules:
      - mount_option_dev_shm_nosuid
  - id: TWGCB-01-012-0019
    title: 設定/dev/shm目錄之noexec選項
    levels:
      - filesystem
    notes: |-
      這項原則設定決定/dev/shm目錄是否啟用noexec選項，以禁止在/dev/shm目錄中啟動可執行二進制檔案
      /dev/shm目錄是系統利用記憶體建立之虛擬磁碟空間，用以存放暫存檔案，一方面存取速度比硬碟快，另一方面可依實際檔案大小動態分配空間
      設定noexec選項，禁止使用者啟動可執行二進制檔案，以避免感染惡意程式
      可設定之參數如下：
      exec：允許啟動可執行二進制檔案
      noexec：禁止啟動可執行二進制檔案
    status: automated
    rules:
      - mount_option_dev_shm_noexec
  - id: TWGCB-01-012-0020
    title: 設定可攜式儲存裝置之nodev選項
    levels:
      - filesystem
    notes: |-
      這項原則設定決定可攜式儲存裝置是否啟用nodev選項，以禁止在可攜式儲存裝置中建立裝置檔案
      設定nodev選項以確保使用者無法在可攜式儲存裝置建立裝置檔案或存取隨機硬體裝置，降低惡意程式感染風險
      可設定之參數如下：
      dev：允許建立裝置檔案
      nodev：禁止建立裝置檔案
    status: manual
  - id: TWGCB-01-012-0021
    title: 設定可攜式儲存裝置之nosuid選項
    levels:
      - filesystem
    notes: |-
      這項原則設定決定可攜式儲存裝置是否啟用nosuid選項，以禁止可攜式儲存裝置存在具有SUID屬性之檔案
      SUID(Set User ID)是針對可執行二進制檔案(Binary file)設計之一項功能，任何使用者執行該程式時，會以該程式之擁有者身分執行，藉由短暫提權讓一般使用者存取未被授權之檔案
      可設定之參數如下：
      suid：允許存在具有SUID屬性之檔案
      nosuid：禁止存在具有SUID屬性之檔案
    status: manual
  - id: TWGCB-01-012-0022
    title: 設定可攜式儲存裝置之noexec選項
    levels:
      - filesystem
    notes: |-
      這項原則設定決定可攜式儲存裝置是否啟用noexec選項，以禁止在可攜式儲存裝置中啟動可執行二進制檔案
      設定noexec選項，禁止使用者啟動可執行二進制檔案，以避免感染惡意程式
      可設定之參數如下：
      exec：允許啟動可執行二進制檔案
      noexec：禁止啟動可執行二進制檔案
    status: manual
  - id: TWGCB-01-012-0023
    title: 設定使用者家目錄之nodev選項
    levels:
      - filesystem
    notes: |-
      這項原則設定決定使用者家目錄是否啟用nodev選項，以禁止在使用者家目錄中建立裝置檔案
      使用者家目錄是系統預設之使用者主目錄，目錄下存放使用者之環境設定與個人檔案
      由於使用者家目錄用途不在於支援裝置，設定nodev選項以確保使用者無法在/home目錄建立裝置檔案或存取隨機硬體裝置，降低惡意程式感染風險
      可設定之參數如下：
      dev：允許建立裝置檔案
      nodev：禁止建立裝置檔案
    status: automated
    rules:
      - mount_option_home_nodev
  - id: TWGCB-01-012-0024
    title: 設定使用者家目錄之nosuid選項
    levels:
      - filesystem
    notes: |-
      這項原則設定決定使用者家目錄是否啟用nosuid選項，以禁止使用者家目錄存在具有SUID屬性之檔案
      使用者家目錄是系統預設之使用者主目錄，目錄下存放使用者之環境設定與個人檔案
      SUID(Set User ID)是針對可執行二進制檔案(Binary file)設計之一項功能，任何使用者執行該程式時，會以該程式之擁有者身分執行，藉由短暫提權讓一般使用者存取未被授權之檔案
      可設定之參數如下：
      suid：允許存在具有SUID屬性之檔案
      nosuid：禁止存在具有SUID屬性之檔案
    status: automated
    rules:
      - mount_option_home_nosuid
  - id: TWGCB-01-012-0025
    title: 設定使用者家目錄之noexec選項
    levels:
      - filesystem
    notes: |-
      這項原則設定決定使用者家目錄是否啟用noexec選項，以禁止在使用者家目錄中啟動可執行二進制檔案
      使用者家目錄是系統預設之使用者主目錄，目錄下存放使用者之環境設定與個人檔案
      設定noexec選項，禁止使用者啟動可執行二進制檔案，以避免感染惡意程式
      可設定之參數如下：
      exec：允許啟動可執行二進制檔案
      noexec：禁止啟動可執行二進制檔案
    status: automated
    rules:
      - mount_option_home_noexec
  - id: TWGCB-01-012-0026
    title: 設定NFS檔案系統之nodev選項
    levels:
      - filesystem
    notes: |-
      這項原則設定決定NFS檔案系統是否啟用nodev選項，以禁止在NFS檔案系統中建立裝置檔案
      設定nodev選項以確保使用者無法在NFS檔案系統中建立裝置檔案或存取隨機硬體裝置，降低惡意程式感染風險
      可設定之參數如下：
      dev：允許建立裝置檔案
      nodev：禁止建立裝置檔案
    status: automated
    rules:
      - mount_option_nodev_remote_filesystems
  - id: TWGCB-01-012-0027
    title: 設定NFS檔案系統之nosuid選項
    levels:
      - filesystem
    notes: |-
      這項原則設定決定NFS檔案系統是否啟用nosuid選項，以禁止NFS檔案系統存在具有SUID屬性之檔案
      SUID(Set User ID)是針對可執行二進制檔案(Binary file)設計之一項功能，任何使用者執行該程式時，會以該程式之擁有者身分執行，藉由短暫提權讓一般使用者存取未被授權之檔案
      可設定之參數如下：
      suid：允許存在具有SUID屬性之檔案
      nosuid：禁止存在具有SUID屬性之檔案
    status: automated
    rules:
      - mount_option_nosuid_remote_filesystems
  - id: TWGCB-01-012-0028
    title: 設定NFS檔案系統之noexec選項
    levels:
      - filesystem
    notes: |-
      這項原則設定決定NFS檔案系統是否啟用noexec選項，以禁止在NFS檔案系統中啟動可執行二進制檔案
      設定noexec選項，禁止使用者啟動可執行二進制檔案，以避免感染惡意程式
      可設定之參數如下：
      exec：允許啟動可執行二進制檔案
      noexec：禁止啟動可執行二進制檔案
    status: automated
    rules:
      - mount_option_noexec_remote_filesystems
  - id: TWGCB-01-012-0029
    title: 設定全域寫入權限目錄之粘滯位
    levels:
      - filesystem
    notes: |-
      這項原則設定決定所有具有全域寫入(World-writable)權限之目錄是否設定粘滯位(Sticky bit)
      設定粘滯位(Sticky bit)確保只有擁有者才能刪除或更名自己建立之檔案，以防止使用者任意刪除或更名其他使用者所建立之檔案
    status: automated
    rules:
      - dir_perms_world_writable_sticky_bits
  - id: TWGCB-01-012-0030
    title: autofs服務
    levels:
      - filesystem
    notes: |-
      這項原則設定決定是否使用autofs服務
      autofs服務可自動掛載或卸載光碟機、USB裝置及NFS檔案系統之掛載點，讓任何使用者都可以使用autofs服務掛載裝置與檔案系統
      當系統不需自動掛載NFS檔案系統或可攜式儲存裝置時，建議停用此服務。如有掛載需求，建議透過設定/etc/fstab檔案方式進行掛載
    status: automated
    rules:
      - service_autofs_disabled
  - id: TWGCB-01-012-0031
    title: USB儲存裝置
    levels:
      - filesystem
    notes: |-
      這項原則設定決定是否使用USB儲存裝置
      USB儲存裝置提供檔案傳輸與儲存方式，USB儲存裝置之廣泛使用，致使USB惡意程式成為滲透入侵之常見手段
      停用USB儲存裝置將減少系統實體攻擊面，以及降低引入惡意程式之風險
    status: automated
    rules:
      - kernel_module_usb-storage_disabled
  - id: TWGCB-01-012-0032
    title: GPG簽章驗證
    levels:
      - system_config
    notes: |-
      這項原則設定決定是否啟用GPG簽章驗證功能
      gpgcheck決定在安裝套件前，是否先進行RPM套件簽章檢查，可用以確保欲安裝之RPM套件來自可信賴來源，避免安裝已被竄改之檔案
      gpgcheck選項存在於/etc/yum.conf、/etc/dnf/dnf.conf設定檔及/etc/yum/repos.d/目錄下所有設定檔
      gpgcheck選項可設定參數如下：
      1：啟用，先進行RPM套件簽章檢查，通過後才能安裝套件
      0：停用，安裝前不進行RPM套件簽章檢查
    status: automated
    rules:
      - ensure_gpgcheck_globally_activated
      - ensure_gpgcheck_never_disabled
  - id: TWGCB-01-012-0033
    title: sudo套件
    levels:
      - system_config
    notes: |-
      這項原則設定決定是否安裝sudo套件，sudo允許合法使用者按照所授予之帳號權限，以管理員身分(superuser)或其他使用者身分執行指令
      sudo預設設定檔為/etc/sudoers，將一般使用者帳號與所授予之權限設定在/etc/sudoers設定檔，一般使用者在需要取得特殊權限時，則可於指令前加上「sudo」並輸入使用者自己之通行碼，即可用管理員身分執行指令
      注意：建議可依系統維運與管理需求，適當賦予使用者執行sudo之權限，並可考量將各使用者之設定存放於不同設定檔中
    status: automated
    rules:
      - package_sudo_installed
  - id: TWGCB-01-012-0034
    title: 設定sudo指令使用pty
    levels:
      - system_config
    notes: |-
      這項原則設定決定sudo指令是否使用pty(pseudo terminal，虛擬終端)
      pty是一對提供雙向通訊之虛擬終端設備，分別為主要(master)與從屬(slave)設備，從屬設備提供模擬硬體終端機設備，主要設備提供模擬終端機程序以操作控制從屬設備
      攻擊者在使用sudo執行惡意程序時，在主程序完成後可能會衍生另一個背景程序保留在終端設備上，sudo設定為使用pty時可避免此情況
    status: automated
    rules:
      - sudo_add_use_pty
  - id: TWGCB-01-012-0035
    title: sudo自定義日誌檔案
    levels:
      - system_config
    notes: |-
      這項原則設定決定是否設定sudo自定義日誌檔案
      預設情況下sudo藉由syslog記錄日誌，但sudo可在設定檔(預設為/etc/sudoers)中自定義日誌檔案，有助於簡化sudo指令之稽核工作
    status: automated
    rules:
      - sudo_custom_logfile
  - id: TWGCB-01-012-0036
    title: AIDE套件
    levels:
      - system_config
    notes: |-
      這項原則設定決定是否安裝AIDE(Advanced Intrusion Detection Environment，先進入侵偵測環境)套件
      AIDE截取檔案系統狀態之快照，包括修改時間、權限及檔案雜湊，藉由將快照與檔案系統之當前狀態進行比較，以檢測系統變更情況，找出被修改或損毀之檔案
      AIDE可藉由檔案完整性檢查，協助系統管理者早期發現系統入侵跡象
      注意：建議可依系統維運與管理需求新增或調整AIDE規則
    status: automated
    rules:
      - package_aide_installed
      - aide_build_database
  - id: TWGCB-01-012-0037
    title: 定期檢查檔案系統完整性
    levels:
      - system_config
    notes: |-
      這項原則設定決定是否使用AIDE工具定期檢查檔案系統完整性
      AIDE截取檔案系統狀態之快照，包括修改時間、權限及檔案雜湊，藉由將快照與檔案系統之當前狀態進行比較，以檢測系統變更情況，找出被修改或損毀之檔案
      定期檢查檔案系統完整性，可協助系統管理者定期確認是否有重要檔案在未經授權之情況下被修改
    status: automated
    rules:
      - aide_periodic_cron_checking
  - id: TWGCB-01-012-0038
    title: 開機載入程式設定檔之所有權
    levels:
      - system_config
    notes: |-
      這項原則設定決定開機載入程式(GRUB)設定檔之擁有者與群組
      GRUB設定檔主要功能是用來記錄載入作業系統核心所使用之參數
      將GRUB設定檔之擁有者與擁有群組設為root，以防止非root使用者變更檔案內容
      備註：如果使用其他開機載入程式(如LILO或EFI GRUB)，請比照上述原則進行設定
    status: automated
    rules:
      - file_groupowner_grub2_cfg
      - file_owner_grub2_cfg
      - file_groupowner_user_cfg
      - file_owner_user_cfg
    related_rules:
      - file_groupowner_efi_grub2_cfg
      - file_owner_efi_grub2_cfg
      - file_groupowner_efi_user_cfg
      - file_owner_efi_user_cfg
  - id: TWGCB-01-012-0039
    title: 開機載入程式設定檔之權限
    levels:
      - system_config
    notes: |-
      這項原則設定決定是否設定開機載入程式(GRUB)設定檔之權限
      GRUB設定檔主要功能是用來記錄載入作業系統核心所使用之參數
      禁止群組與其他身分讀取、寫入及執行GRUB設定檔，以防止非root使用者取得或修改開機參數，進而危及系統安全
      備註：如果使用其他開機載入程式(如LILO或EFI GRUB)，請比照上述原則進行設定
    status: automated
    rules:
      - file_permissions_grub2_cfg
      - file_permissions_user_cfg
    related_rules:
      - file_permissions_efi_grub2_cfg
      - file_permissions_efi_user_cfg
  - id: TWGCB-01-012-0040
    title: 開機載入程式之通行碼
    levels:
      - system_config
    notes: |-
      這項原則設定決定是否設定開機載入程式之通行碼，以限制需通過通行碼鑑別後，才能設定開機載入程式之參數
      設定通行碼保護開機載入程式，可避免攻擊者開機進入單一使用者或維護模式，不需鑑別root身分，即可取得系統上所有檔案之存取權限
    status: automated
    rules:
      - grub2_password
    related_rules:
      - grub2_uefi_password
  - id: TWGCB-01-012-0041
    title: 單一使用者模式身分鑑別
    levels:
      - system_config
    notes: |-
      這項原則設定決定單一使用者模式(Single user mode)是否啟用身分鑑別功能
      當系統在開機載入過程發生問題時，將使用單一使用者模式(或稱為救援模式)進行還原
      設定單一使用者模式需使用身分鑑別，可防止攻擊者將系統重新開機後，不需身分鑑別即可進入單一使用者模式，進而危害系統安全
    status: automated
    rules:
      - require_singleuser_auth
      - require_emergency_target_auth
  - id: TWGCB-01-012-0042
    title: 核心傾印功能
    levels:
      - system_config
    notes: |-
      這項原則設定決定是否啟用核心傾印(Core dump)功能
      核心傾印檔案是程式異常終止時，系統將當時記憶體內容以檔案方式記錄下來所產生之記憶體映像檔案，可供程式除錯之用
      禁止使用者與SUID程式產生核心傾印檔案，避免核心傾印檔案洩露如記憶體位址或空間配置等敏感資訊
    status: automated
    rules:
      - disable_users_coredumps
      - sysctl_fs_suid_dumpable
      - service_systemd-coredump_disabled
      - coredump_disable_storage
      - sysctl_kernel_core_pattern
  - id: TWGCB-01-012-0043
    title: 記憶體位址空間配置隨機載入
    levels:
      - system_config
    notes: |-
      這項原則設定決定系統開機時是否立即啟用記憶體位址空間配置隨機載入(Address space layout randomization, ASLR)功能
      ASLR利用隨機方式配置資料位址，使得敏感資料(例如作業系統核心程式)能配置到一個惡意程式未能事先得知之位址
      啟用記憶體位址空間配置隨機載入，提高攻擊難度，以降低緩衝區溢位攻擊之威脅
      可設定參數如下：
      0：停用ASLR功能
      1：隨機配置堆疊(Stack)、記憶體映射函數(mmap)及vDSO(Virtual Dynamically-linked Shared Object，虛擬動態連結共享物件)頁面
      2：隨機配置堆疊(Stack)、記憶體映射函數(mmap)、vDSO頁面及堆積(Heap)
    status: automated
    rules:
      - sysctl_kernel_randomize_va_space
  - id: TWGCB-01-012-0044
    title: 設定全系統加密原則
    levels:
      - system_config
    notes: |-
      這項原則設定決定採取何種全系統加密原則
      全系統加密原則(System-wide crypto-policies)與加密核心元件，允許在全系統範圍使用一致性之加密原則
      可設定原則如下：
      DEFAULT：預設全系統加密原則。允許使用TLSv1.2與1.3協定，以及IKEv2與SSH2協定，要求RSA密鑰與Diffie-Hellman金鑰至少為2,048位元
      LEGACY：此原則可確保與Red Hat Enterprise Linux 5與更舊版本之最大兼容性，比DEFAULT原則多支援TLSv1.0與1.1協定，並允許使用DSA、3DES及RC4演算法，要求RSA密鑰與Diffie-Hellman金鑰至少為1,024位元
      FUTURE：採取保守之安全原則，可承受近期相關攻擊，不允許使用SHA-1演算法，要求RSA密鑰與Diffie-Hellman金鑰至少為3,072位元
      FIPS：符合FIPS140-2要求原則，使用內建之fips-mode-setup工具，將作業系統切換到FIPS模式
      設定全系統加密原則使用FUTURE或FIPS原則，避免使用較舊且易被攻擊之加密演算法
    status: automated
    rules:
      - configure_crypto_policy
      - enable_fips_mode
      - var_system_crypto_policy=fips
  - id: TWGCB-01-012-0045
    title: /etc/passwd檔案所有權
    levels:
      - system_config
    notes: |-
      這項原則設定決定/etc/passwd檔案擁有者與群組
      /etc/passwd記錄每位使用者之名稱、通行碼、使用者ID、群組ID及家目錄等資訊
      設定/etc/passwd檔案擁有者與群組為root，避免/etc/passwd檔案遭未授權使用者修改，降低檔案被竄改後進一步利用於其他惡意攻擊之風險
    status: automated
    rules:
      - file_groupowner_etc_passwd
      - file_owner_etc_passwd
  - id: TWGCB-01-012-0046
    title: /etc/passwd檔案權限
    levels:
      - system_config
    notes: |-
      這項原則設定決定/etc/passwd檔案權限
      /etc/passwd記錄每位使用者之名稱、通行碼、使用者ID、群組ID及家目錄等資訊
      將/etc/passwd檔案權限設為僅root擁有讀取與寫入權限，其餘所有使用者僅可讀取，避免/etc/passwd檔案遭未授權使用者修改，降低檔案被竄改後進一步利用於其他惡意攻擊之風險
    status: automated
    rules:
      - file_permissions_etc_passwd
  - id: TWGCB-01-012-0047
    title: /etc/shadow檔案所有權
    levels:
      - system_config
    notes: |-
      這項原則設定決定/etc/shadow檔案擁有者與群組
      /etc/shadow記錄每個使用者帳號加密過後之通行碼、最後變更通行碼之日期及下次可變更通行碼前之經過天數等資訊
      若攻擊者取得/etc/shadow檔案後，可嘗試透過通行碼破解程式取得通行碼後進行攻擊
      設定/etc/shadow檔案擁有者與群組，以保護帳號通行碼資訊，降低檔案被竄改後進一步利用於其他惡意攻擊之風險
    status: automated
    rules:
      - file_groupowner_etc_shadow
      - file_owner_etc_shadow
  - id: TWGCB-01-012-0048
    title: /etc/shadow檔案權限
    levels:
      - system_config
    notes: |-
      這項原則設定決定/etc/shadow檔案權限
      /etc/shadow記錄每個使用者帳號加密過後之通行碼、最後變更通行碼之日期及下次可變更通行碼前之經過天數等資訊
      若攻擊者取得/etc/shadow檔案後，可嘗試透過通行碼破解程式取得通行碼後進行攻擊
      將/etc/shadow檔案權限設為000(所有使用者不具有讀取、寫入及執行權限)，以保護帳號通行碼資訊，降低檔案被竄改後進一步利用於其他惡意攻擊之風險
    status: automated
    rules:
      - file_permissions_etc_shadow
  - id: TWGCB-01-012-0049
    title: /etc/group檔案所有權
    levels:
      - system_config
    notes: |-
      這項原則設定決定/etc/group檔案擁有者與群組
      /etc/group記錄每個群組之名稱、通行碼、ID及屬於該群組之使用者清單
      設定/etc/group檔案擁有者與群組為root，避免/etc/group檔案遭未授權使用者修改
    status: automated
    rules:
      - file_groupowner_etc_group
      - file_owner_etc_group
  - id: TWGCB-01-012-0050
    title: /etc/group檔案權限
    levels:
      - system_config
    notes: |-
      這項原則設定決定/etc/group檔案權限
      /etc/group記錄每個群組之名稱、通行碼、ID及屬於該群組之使用者清單
      設定/etc/group檔案權限，僅root擁有讀寫權限，其餘所有使用者僅可讀取，避免/etc/group檔案遭未授權使用者修改
    status: automated
    rules:
      - file_permissions_etc_group
  - id: TWGCB-01-012-0051
    title: /etc/gshadow檔案所有權
    levels:
      - system_config
    notes: |-
      這項原則設定決定/etc/gshadow檔案擁有者與群組
      /etc/gshadow記錄每個群組加密過後之通行碼，以及使用者與管理者資訊，攻擊者讀取/etc/gshadow檔案後，可嘗試透過通行碼破解程式取得通行碼後進行攻擊
      設定/etc/gshadow檔案擁有者與群組，以保護群組帳號通行碼資訊，降低檔案被竄改後進一步利用於其他惡意攻擊之風險
    status: automated
    rules:
      - file_groupowner_etc_gshadow
      - file_owner_etc_gshadow
  - id: TWGCB-01-012-0052
    title: /etc/gshadow檔案權限
    levels:
      - system_config
    notes: |-
      這項原則設定決定/etc/gshadow檔案權限
      /etc/gshadow記錄每個群組加密過後之通行碼，以及使用者與管理者資訊，攻擊者讀取/etc/gshadow檔案後，可嘗試透過通行碼破解程式取得通行碼後進行攻擊
      設定/etc/gshadow檔案權限為000(所有使用者不具有讀取、寫入及執行權限)，以保護群組帳號通行碼資訊，降低檔案被竄改後進一步利用於其他惡意攻擊之風險
    status: automated
    rules:
      - file_permissions_etc_gshadow
  - id: TWGCB-01-012-0053
    title: /etc/passwd-檔案所有權
    levels:
      - system_config
    notes: |-
      這項原則設定決定/etc/passwd-檔案擁有者與群組
      /etc/passwd-備份每位使用者之名稱、通行碼、使用者ID、群組ID及家目錄等資訊
      設定/etc/passwd-檔案擁有者與群組為root，避免/etc/passwd-檔案遭未授權使用者修改，降低檔案被竄改後進一步利用於其他惡意攻擊之風險
    status: automated
    rules:
      - file_groupowner_backup_etc_passwd
      - file_owner_backup_etc_passwd
  - id: TWGCB-01-012-0054
    title: /etc/passwd-檔案權限
    levels:
      - system_config
    notes: |-
      這項原則設定決定/etc/passwd-檔案權限
      /etc/passwd-備份每位使用者之名稱、通行碼、使用者ID、群組ID及家目錄等資訊
      設定/etc/passwd-檔案權限，僅root擁有讀取與寫入權限，其餘所有使用者僅可讀取，避免/etc/passwd-檔案遭未授權使用者修改，降低檔案被竄改後進一步利用於其他惡意攻擊之風險
    status: automated
    rules:
      - file_permissions_backup_etc_passwd
  - id: TWGCB-01-012-0055
    title: /etc/shadow-檔案所有權
    levels:
      - system_config
    notes: |-
      這項原則設定決定/etc/shadow-檔案擁有者與群組
      /etc/shadow-備份每個使用者帳號加密過後之通行碼、最後變更通行碼之日期及下次可變更通行碼前之經過天數等資訊
      若攻擊者取得/etc/shadow-檔案，可嘗試透過通行碼破解程式取得通行碼後進行攻擊
      設定/etc/shadow-檔案所有權，以保護帳號通行碼資訊，降低檔案被竄改後進一步利用於其他惡意攻擊之風險
    status: automated
    rules:
      - file_groupowner_backup_etc_shadow
      - file_owner_backup_etc_shadow
  - id: TWGCB-01-012-0056
    title: /etc/shadow-檔案權限
    levels:
      - system_config
    notes: |-
      這項原則設定決定/etc/shadow-檔案權限
      /etc/shadow-備份每個使用者帳號加密過後之通行碼、最後變更通行碼之日期及下次可變更通行碼前之經過天數等資訊
      若攻擊者取得/etc/shadow-檔案，可嘗試透過通行碼破解程式取得通行碼後進行攻擊
      設定/etc/shadow-檔案權限為000(所有使用者不具有讀取、寫入及執行權限)，以保護帳號通行碼資訊，降低檔案被竄改後進一步利用於其他惡意攻擊之風險
    status: automated
    rules:
      - file_permissions_backup_etc_shadow
  - id: TWGCB-01-012-0057
    title: /etc/group-檔案所有權
    levels:
      - system_config
    notes: |-
      這項原則設定決定/etc/group-檔案擁有者與群組
      /etc/group-備份每個群組之名稱、通行碼、ID及屬於該群組之使用者清單
      設定/etc/group-檔案擁有者與群組為root，避免/etc/group-檔案遭未授權使用者修改
    status: automated
    rules:
      - file_groupowner_backup_etc_group
      - file_owner_backup_etc_group
  - id: TWGCB-01-012-0058
    title: /etc/group-檔案權限
    levels:
      - system_config
    notes: |-
      這項原則設定決定/etc/group-檔案權限
      /etc/group-備份每個群組之名稱、通行碼、ID及屬於該群組之使用者清單
      設定/etc/group-檔案權限，僅root擁有讀取與寫入權限，其餘所有使用者僅可讀取，避免/etc/group-檔案遭未授權使用者修改
    status: automated
    rules:
      - file_permissions_backup_etc_group
  - id: TWGCB-01-012-0059
    title: /etc/gshadow-檔案所有權
    levels:
      - system_config
    notes: |-
      這項原則設定決定/etc/gshadow-檔案擁有者與群組
      /etc/gshadow-備份每個群組加密過後之通行碼，以及使用者與管理者資訊，攻擊者讀取/etc/gshadow-檔案後，可嘗試透過通行碼破解程式取得通行碼後進行攻擊
      設定/etc/gshadow-檔案所有權，以保護群組帳號通行碼資訊，降低檔案被竄改後進一步利用於其他惡意攻擊之風險
    status: automated
    rules:
      - file_groupowner_backup_etc_gshadow
      - file_owner_backup_etc_gshadow
  - id: TWGCB-01-012-0060
    title: /etc/gshadow-檔案權限
    levels:
      - system_config
    notes: |-
      這項原則設定決定/etc/gshadow-檔案權限
      /etc/gshadow-備份每個群組加密過後之通行碼，以及使用者與管理者資訊，若攻擊者讀取/etc/gshadow-檔案後，可嘗試透過通行碼破解程式取得通行碼後進行攻擊
      設定/etc/gshadow-檔案權限為000(所有使用者不具有讀取、寫入及執行權限)，以保護群組帳號通行碼資訊，降低檔案被竄改後進一步利用於其他惡意攻擊之風險
    status: automated
    rules:
      - file_permissions_backup_etc_gshadow
  - id: TWGCB-01-012-0061
    title: 其他使用者寫入具有全域寫入權限之檔案
    levels:
      - system_config
    notes: |-
      這項原則設定決定其他使用者是否允許寫入具有全域寫入(World-writable)權限之檔案
      具有全域寫入權限之檔案可被任何使用者修改，錯誤或不完整之程式碼將可能影響系統運作或危害系統安全
      設定其他使用者不能寫入具有全域寫入權限之檔案，以避免系統重要檔案被未經授權竄改
    status: automated
    rules:
      - file_permissions_unauthorized_world_writable
  - id: TWGCB-01-012-0062
    title: 檢查所有檔案與目錄之擁有者
    levels:
      - system_config
    notes: |-
      這項原則設定決定是否所有檔案與目錄擁有者皆為合法使用者
      不屬於合法使用者之檔案可能是由入侵者植入、不正確之軟體安裝、不完整之軟體移除或已遭刪除使用者所遺留之檔案
      確認所有檔案與目錄擁有者皆為合法使用者，以避免新使用者帳號與已被刪除使用者帳號相同時，可以存取前任使用者所建立之檔案，將可能存取未被授權之檔案
    status: automated
    rules:
      - no_files_unowned_by_user
  - id: TWGCB-01-012-0063
    title: 檢查所有檔案與目錄之擁有群組
    levels:
      - system_config
    notes: |-
      這項原則設定決定是否所有檔案與目錄擁有群組皆為合法群組
      不屬於合法群組之檔案可能是由入侵者植入、不正確之軟體安裝、不完整之軟體移除或已遭刪除使用者所遺留之檔案
      確認所有檔案與目錄擁有群組皆為合法群組，以避免新使用者帳號與已被刪除使用者帳號相同時，可以存取前任使用者所屬群組之檔案，將可能存取未被授權之檔案
    status: automated
    rules:
      - file_permissions_ungroupowned
  - id: TWGCB-01-012-0064
    title: 所有具有全域寫入權限目錄之擁有者
    levels:
      - system_config
    notes: |-
      這項原則設定決定是否所有具有全域寫入權限之目錄擁有者為root或其他系統帳號
      若具有全域寫入權限之目錄之擁有者為一般使用者，該使用者將可刪除或置換其他使用者所建立之檔案
      設定所有具有全域寫入權限之目錄擁有者為root或其他系統帳號，避免系統資源遭未經授權存取
    status: automated
    rules:
      - dir_perms_world_writable_root_owned
  - id: TWGCB-01-012-0065
    title: 所有具有全域寫入權限目錄之擁有群組
    levels:
      - system_config
    notes: |-
      這項原則設定決定是否所有具有全域寫入權限之目錄擁有群組為root或其他系統群組(sys、bin或應用程式群組)
      若具有全域寫入權限之目錄之擁有群組為一般使用者群組，該群組使用者將可刪除或置換其他使用者所建立之檔案
    status: automated
    rules:
      - dir_perms_world_writable_system_owned
      - dir_perms_world_writable_system_owned_group
  - id: TWGCB-01-012-0066
    title: 系統命令檔案權限
    levels:
      - system_config
    notes: |-
      這項原則決定是否設定系統命令檔案權限，使系統命令檔案具有755或更低權限
      系統命令檔案包含儲存在作業系統預設可執行檔案目錄之檔案，以及存在於系統預設可執行檔案搜索路徑目錄之檔案
      限制權限以保護系統命令檔案，避免被未經授權竄改，使管理者與系統服務可正常執行指令
    status: automated
    rules:
      - file_permissions_binary_dirs
  - id: TWGCB-01-012-0067
    title: 系統命令檔案擁有者
    levels:
      - system_config
    notes: |-
      這項原則決定是否設定系統命令檔案擁有者
      系統命令檔案包含儲存在作業系統預設可執行檔案目錄之檔案，以及存在於系統預設可執行檔案搜索路徑目錄之檔案
      設定root擁有，以保護系統命令檔案，避免被未經授權竄改，使管理者與系統服務可正常執行指令
    status: automated
    rules:
      - file_ownership_binary_dirs
  - id: TWGCB-01-012-0068
    title: 系統命令檔案擁有群組
    levels:
      - system_config
    notes: |-
      這項原則決定是否設定系統命令檔案擁有群組
      系統命令檔案包含儲存在作業系統預設可執行檔案目錄之檔案，以及存在於系統預設可執行檔案搜索路徑目錄之檔案
      設定root群組擁有，以保護系統命令檔案，避免被未經授權竄改，使管理者與系統服務可正常執行指令
    status: automated
    rules:
      - file_groupownership_system_commands_dirs
  - id: TWGCB-01-012-0069
    title: 程式庫檔案權限
    levels:
      - system_config
    notes: |-
      這項原則決定是否設定程式庫檔案權限，使程式庫檔案具有755或更低權限
      系統程序在啟動或運行時會連結到程式庫檔案，將程式庫檔案載入到系統核心之記憶體空間，程式庫檔案還包含用以升級特權執行之特權程序
      限制權限以保護程式庫檔案，避免被未經授權竄改，維持系統完整性
    status: automated
    rules:
      - file_permissions_library_dirs
  - id: TWGCB-01-012-0070
    title: 程式庫檔案擁有者
    levels:
      - system_config
    notes: |-
      這項原則決定是否設定程式庫檔案擁有者
      系統程序在啟動或運行時會連結到程式庫檔案，將程式庫檔案載入到系統核心之記憶體空間，程式庫檔案還包含用以升級特權執行之特權程序
      設定root擁有，以保護程式庫檔案，避免被未經授權竄改，維持系統完整性
    status: automated
    rules:
      - file_ownership_library_dirs
  - id: TWGCB-01-012-0071
    title: 程式庫檔案擁有群組
    levels:
      - system_config
    notes: |-
      這項原則決定是否設定程式庫檔案擁有群組
      系統程序在啟動或運行時會連結到程式庫檔案，將程式庫檔案載入到系統核心之記憶體空間，程式庫檔案還包含用以升級特權執行之特權程序
      設定root群組擁有，以保護程式庫檔案避免被未經授權竄改，維持系統完整性
    status: manual
  - id: TWGCB-01-012-0072
    title: 帳號不使用空白通行碼
    levels:
      - system_config
    notes: |-
      這項原則設定決定是否允許存在使用空白通行碼之帳號
      使用空白通行碼意謂著任何人皆可以此帳號登入系統，並以該帳號之權限執行相關指令，將可能危害系統安全
      設定帳號都必須具有通行碼或被鎖定，以防止未經授權之使用者登入該帳號
    status: automated
    rules:
      - no_empty_passwords_etc_shadow
  - id: TWGCB-01-012-0073
    title: root帳號之路徑變數
    levels:
      - system_config
    notes: |-
      這項原則設定決定是否允許root帳號之路徑(PATH)變數存在相對路徑或空目錄(例如：「.」、「..」、路徑開頭不是「/」及空元素)
      root帳號可以執行系統上所有指令，若PATH設定錯誤，root將可能執行到偽裝之程式檔案，危害系統安全
      .：目前目錄
      ..：上一層目錄
    status: automated
    rules:
      - root_path_no_dot
  - id: TWGCB-01-012-0074
    title: root帳號之路徑變數不包含world-writable或group-writable目錄
    levels:
      - system_config
    notes: |-
      這項原則設定決定是否允許root帳號之路徑(PATH)變數存在具有world-writable權限或group-writable權限之目錄
      root可以執行系統上所有指令，若PATH變數包含world-writable(全域寫入)權限或group-writable(群組身分寫入)權限之目錄，將可能導致root執行到惡意程式，危害系統安全
    status: automated
    rules:
      - accounts_root_path_dirs_no_write
  - id: TWGCB-01-012-0075
    title: /etc/passwd檔案行首之「+」符號
    levels:
      - system_config
    notes: |-
      這項原則設定決定/etc/passwd檔案行首是否允許存在「+」符號
      「+」符號代表不需輸入通行碼即可從網路資訊服務(NIS)主機取得帳號、通行碼、主機名稱或群組等資訊
      當NIS沒有啟動或NIS設定錯誤時，/etc/passwd檔案行首若存在「+」符號，攻擊者可使用帳號「+」與空白通行碼登入，提供攻擊者一個獲得系統權限之途徑
    status: automated
    rules:
      - no_legacy_plus_entries_etc_passwd
  - id: TWGCB-01-012-0076
    title: /etc/shadow檔案行首之「+」符號
    levels:
      - system_config
    notes: |-
      這項原則設定決定/etc/shadow檔案行首是否允許存在「+」符號
      「+」符號代表不需輸入通行碼即可從網路資訊服務(NIS)主機取得帳號、通行碼、主機名稱或群組等資訊
      當NIS沒有啟動或NIS設定錯誤時，/etc/shadow檔案行首若存在「+」符號，攻擊者可使用帳號「+」與空白通行碼登入，提供攻擊者一個獲得系統權限之途徑
    status: automated
    rules:
      - no_legacy_plus_entries_etc_shadow
  - id: TWGCB-01-012-0077
    title: /etc/group檔案行首之「+」符號
    levels:
      - system_config
    notes: |-
      這項原則設定決定/etc/group檔案行首是否允許存在「+」符號
      「+」符號代表不需輸入通行碼即可從網路資訊服務(NIS)主機取得帳號、通行碼、主機名稱或群組等資訊
      當NIS沒有啟動或NIS設定錯誤時，/etc/group檔案行首若存在「+」符號，攻擊者可使用帳號「+」與空白通行碼登入，提供攻擊者一個獲得系統權限之途徑
    status: automated
    rules:
      - no_legacy_plus_entries_etc_group
  - id: TWGCB-01-012-0078
    title: UID=0之帳號
    levels:
      - system_config
    notes: |-
      這項原則設定決定系統除了root帳號外，其他帳號之UID是否允許設為0
      UID=0之帳號具有系統管理權限
    status: automated
    rules:
      - accounts_no_uid_except_zero
  - id: TWGCB-01-012-0079
    title: 使用者家目錄權限
    levels:
      - system_config
    notes: |-
      這項原則設定決定使用者家目錄權限
      使用者家目錄是系統預設之使用者主目錄，目錄下存放使用者之環境設定與個人檔案，因此任何使用者皆不應具有可寫入其他使用者家目錄之權限
      使用者家目錄應限制群組不具寫入(g-w)權限，其他使用者不具讀取、寫入及執行(o-rwx)權限，避免遭未經授權存取與竊取資料
    status: automated
    rules:
      - file_permissions_home_directories
  - id: TWGCB-01-012-0080
    title: 使用者家目錄擁有者
    levels:
      - system_config
    notes: |-
      這項原則設定決定使用者家目錄擁有者是否為使用者
      使用者家目錄是系統預設之使用者主目錄，目錄下存放使用者之環境設定與個人檔案
      設定使用者家目錄為使用者擁有，以確保使用者個人資料安全
    status: automated
    rules:
      - file_ownership_home_directories
  - id: TWGCB-01-012-0081
    title: 使用者家目錄擁有群組
    levels:
      - system_config
    notes: |-
      這項原則設定決定使用者家目錄擁有群組是否為使用者群組
      使用者家目錄是系統預設之使用者主目錄，目錄下存放使用者之環境設定與個人檔案
      若使用者家目錄擁有群組GID與使用者群組GID不同，將導致其他使用者可存取該使用者之檔案
      設定使用者家目錄為使用者群組擁有，以確保使用者個人資料安全
    status: automated
    rules:
      - file_groupownership_home_directories
  - id: TWGCB-01-012-0082
    title: 使用者家目錄之「.」檔案權限
    levels:
      - system_config
    notes: |-
      這項原則設定決定是否設定使用者家目錄之「.」檔案權限，使用者家目錄之「.」檔案包含使用者之初始化檔案與其他設定檔
      限制使用者家目錄之「.」檔案寫入權限，以避免惡意人士藉由竊取或修改使用者資料，進而取得該使用者之系統權限
    status: automated
    rules:
      - accounts_user_dot_no_world_writable_programs
  - id: TWGCB-01-012-0083
    title: 使用者家目錄之「.forward」檔案
    levels:
      - system_config
    notes: |-
      這項原則設定決定是否移除使用者家目錄之「.forward」檔案
      「.forward」檔案用於設定將使用者郵件轉發到指定之電子郵件信箱
      移除「.forward」檔案以停用郵件轉發功能，避免機敏資料洩漏
    status: automated
    rules:
      - no_forward_files
  - id: TWGCB-01-012-0084
    title: 使用者家目錄之「.netrc」檔案
    levels:
      - system_config
    notes: |-
      這項原則設定決定是否移除使用者家目錄之「.netrc」檔案
      「.netrc」檔案包含用於登入遠端FTP主機進行檔案傳輸之帳號與明文通行碼，移除「.netrc」檔案以避免對遠端FTP主機造成之風險
    status: automated
    rules:
      - no_netrc_files
  - id: TWGCB-01-012-0085
    title: 使用者家目錄之「.rhosts」檔案
    levels:
      - system_config
    notes: |-
      這項原則設定決定是否移除使用者家目錄之「.rhosts」檔案
      「.rhosts」檔案用於指定那個使用者可以不需要輸入通行碼即可執行rsh遠端連線，移除「.rhosts」檔案以避免遭惡意人士取得可攻擊其他遠端主機之資訊
    status: automated
    rules:
      - no_rsh_trust_files
  - id: TWGCB-01-012-0086
    title: 檢查/etc/passwd檔案設定之群組
    levels:
      - system_config
    notes: |-
      這項原則設定決定是否檢查/etc/passwd檔案設定之群組，是否都存在於/etc/group檔案中
      在/etc/passwd檔案中，使用者帳號設定之群組，若不存在於/etc/group檔案中，代表群組權限管理不恰當，將可能對系統安全構成威脅
    status: automated
    rules:
      - gid_passwd_group_same
  - id: TWGCB-01-012-0087
    title: 唯一之UID
    levels:
      - system_config
    notes: |-
      這項原則設定決定是否檢查/etc/passwd檔案之使用者帳號UID(User Identifier，使用者識別碼)皆不相同
      儘管透過useradd指令新增使用者帳號時，不允許建立重複之UID，但系統管理者可手動編輯/etc/passwd檔案並更改UID，造成UID重複之情形
      為每個使用者帳號設定唯一之UID，以提供適當之存取防護
    status: automated
    rules:
      - account_unique_id
  - id: TWGCB-01-012-0088
    title: 唯一之GID
    levels:
      - system_config
    notes: |-
      這項原則設定決定是否檢查/etc/group檔案之群組GID(Group Identifier，群組識別碼)皆不相同
      儘管透過groupadd指令新增群組時，不允許建立重複之GID，但系統管理者可手動編輯/etc/group檔案並更改GID，造成GID重複之情形
      為每個群組設定唯一之GID，以提供適當之存取防護
    status: automated
    rules:
      - group_unique_id
  - id: TWGCB-01-012-0089
    title: 唯一之使用者帳號名稱
    levels:
      - system_config
    notes: |-
      這項原則設定決定是否檢查/etc/passwd檔案之使用者帳號名稱，並確認每個使用者帳號名稱皆不相同
      儘管透過useradd指令新增使用者帳號時，不允許建立重複之帳號名稱，但系統管理者可手動編輯/etc/passwd檔案並更改帳號名稱，造成帳號名稱重複之情形
      為每個使用者帳號設定唯一之名稱，以提供適當之存取防護
    status: automated
    rules:
      - account_unique_name
  - id: TWGCB-01-012-0090
    title: 唯一之群組名稱
    levels:
      - system_config
    notes: |-
      這項原則設定決定是否檢查/etc/group檔案之群組名稱，並確認每個群組名稱皆不相同
      儘管透過groupadd指令新增群組時，不允許建立重複之群組名稱，但系統管理者可手動編輯/etc/group檔案並更改群組名稱，造成群組名稱重複之情形
      為每個群組設定唯一之群組名稱，以提供適當之存取防護
    status: automated
    rules:
      - group_unique_name
  - id: TWGCB-01-012-0091
    title: shadow群組成員
    levels:
      - system_config
    notes: |-
      這項原則設定決定shadow群組成員是否無使用者
      隸屬於shadow群組之使用者具有可讀取/etc/shadow檔案之權限，若攻擊者可讀取/etc/shadow檔案，使用者通行碼與其他安全資訊將可能被攻擊者破解並執行進一步攻擊
      設定shadow群組不包含任何使用者，以降低系統風險
    status: automated
    rules:
      - ensure_shadow_group_empty
  - id: TWGCB-01-012-0092
    title: xinetd套件
    levels:
      - services
    notes: |-
      這項原則設定決定是否移除xinetd套件
      xinetd(Extended Internet daemon)套件取代原有之inetd守護程序，負責管理網路相關服務
      xinetd監聽來自網路之請求，進而啟動相應服務，可以用來啟動使用特權埠與非特權埠之服務
      移除xinetd套件可減少系統被攻擊面
    status: automated
    rules:
      - package_xinetd_removed
  - id: TWGCB-01-012-0093
    title: chrony校時設定
    levels:
      - services
    notes: |-
      這項原則設定決定是否設定chrony守護程序之校時來源
      chrony是一個守護程序，藉由實作網路時間協定(NTP)，以於各系統之間同步系統時間，並可使用高準確之校時來源
      設定chrony校時來源，以確保系統時間正確
    status: automated
    rules:
      - chronyd_configure_pool_and_server
  - id: TWGCB-01-012-0094
    title: rsyncd服務
    levels:
      - services
    notes: |-
      這項原則設定決定是否啟用rsyncd服務
      rsyncd服務用於透過網路連接在兩台電腦之間同步檔案與目錄，並可利用差分編碼以減少資料傳輸量
      由於rsyncd服務使用未加密協議進行資料傳輸，停用rsyncd服務可降低資安風險
    status: automated
    rules:
      - service_rsyncd_disabled
    related_rules:
      - package_rsync_removed
  - id: TWGCB-01-012-0095
    title: avahi-daemon服務
    levels:
      - services
    notes: |-
      這項原則設定決定是否啟用avahi-daemon服務，以運行Avahi伺服器
      Avahi實作零配置網路服務規範(zeroconf)，使用者無需進行手動設定，系統即可自動連線區域網路中之各種網路裝置與服務(如印表機、DNS)
      停用avahi-daemon服務可減少系統被攻擊面
    status: automated
    rules:
      - service_avahi-daemon_disabled
    related_rules:
      - package_avahi_removed
  - id: TWGCB-01-012-0096
    title: SNMP服務
    levels:
      - services
    notes: |-
      這項原則設定決定是否啟用SNMP服務
      SNMP(Simple Network Management Protocol，簡單網路管理協定)服務用於監聽來自SNMP管理系統之SNMP命令，執行命令或蒐集資訊，然後將結果送回請求系統
      SNMP伺服器可以使用SNMPv1與SNMPv2進行通訊，因SNMPv1與SNMPv2使用不安全之明文傳輸設計，停用SNMP服務可減少系統被攻擊面
    status: automated
    rules:
      - snmpd_use_newer_protocol
    related_rules:
      - service_snmpd_disabled
  - id: TWGCB-01-012-0097
    title: Squid服務
    levels:
      - services
    notes: |-
      這項原則設定決定是否啟用squid服務，以運行代理伺服器功能
      攻擊者透過代理伺服器攻擊其他伺服器時，可以藉此隱匿身分，甚至進而進入到其他受保護之網段中
      停用Squid服務可減少系統被攻擊面
    status: automated
    rules:
      - service_squid_disabled
    related_rules:
      - package_squid_removed
  - id: TWGCB-01-012-0098
    title: Samba服務
    levels:
      - services
    notes: |-
      這項原則設定決定是否啟用Samba服務
      Samba運用SMB ( Server message block)協定分享目錄與檔案予微軟Windows作業系統
      停用Samba服務可減少系統被攻擊面
    status: automated
    rules:
      - service_smb_disabled
    related_rules:
      - package_samba_removed
  - id: TWGCB-01-012-0099
    title: FTP伺服器
    levels:
      - services
    notes: |-
      這項原則設定決定是否啟用FTP伺服器服務
      FTP(File Transfer Protocol，檔案傳輸協定)可透過網路連接在兩台電腦之間傳輸檔案，因使用明文傳輸方式，故有資料洩露風險
      停用FTP伺服器服務可減少系統被攻擊面
      如有FTP使用需求，建議改採SFTP，以保護資料傳輸安全
    status: automated
    rules:
      - service_vsftpd_disabled
    related_rules:
      - package_vsftpd_removed
  - id: TWGCB-01-012-0100
    title: NIS伺服器
    levels:
      - services
    notes: |-
      這項原則設定決定是否啟用NIS伺服器服務
      NIS(Network Information System，網路資訊服務)可提供帳號、通行碼、主機名稱或群組等資訊進行登入鑑別，NIS使用較不嚴謹之身分鑑別機制，易受到服務阻斷攻擊
      停用NIS伺服器服務可減少系統被攻擊面
    status: automated
    rules:
      - service_ypserv_disabled
    related_rules:
      - package_ypserv_removed
  - id: TWGCB-01-012-0101
    title: kdump服務
    levels:
      - services
    notes: |-
      這項原則設定決定是否啟用kdump(核心當機時之傾印機制)服務
      kdump是Linux核心其中一項功能，當系統當機時，kdump會被觸發並匯出一個記憶體映像檔案，該映像檔可用於除錯以找出導致當機之原因
      啟用kdump服務保留作業系統狀態資訊，以提供系統管理者修復系統所需相關資訊
    status: manual
  - id: TWGCB-01-012-0102
    title: NIS用戶端套件
    levels:
      - softwares
    notes: |-
      這項原則設定決定是否安裝NIS用戶端套件(ypbind)
      NIS(Network Information System，網路資訊服務)可提供帳號、通行碼、主機名稱或群組等資訊進行登入鑑別，NIS使用較不嚴謹之身分鑑別機制，易受到服務阻斷攻擊
      移除NIS用戶端套件，以避免使用較不安全之NIS服務
    status: automated
    rules:
      - package_ypbind_removed
  - id: TWGCB-01-012-0103
    title: telnet用戶端套件
    levels:
      - softwares
    notes: |-
      這項原則設定決定是否安裝telnet用戶端套件
      telnet協定不安全且未加密傳輸，將可能導致機敏資料外洩
      移除telnet用戶端套件，以避免使用不安全之telnet服務
    status: automated
    rules:
      - package_telnet_removed
  - id: TWGCB-01-012-0104
    title: telnet伺服器套件
    levels:
      - softwares
    notes: |-
      這項原則設定決定是否安裝telnet伺服器套件(telnet-server)
      telnet協定不安全且未加密傳輸，將可能導致機敏資料外洩
      移除telnet伺服器套件，以避免使用不安全之telnet服務
    status: automated
    rules:
      - package_telnet-server_removed
  - id: TWGCB-01-012-0105
    title: rsh伺服器套件
    levels:
      - softwares
    notes: |-
      這項原則設定決定是否安裝rsh伺服器套件(rsh-server)
      rsh伺服器提供未加密之遠端存取服務，將可能導致機敏資料外洩
      移除rsh伺服器套件，以避免使用不安全之rsh服務
    status: automated
    rules:
      - package_rsh-server_removed
  - id: TWGCB-01-012-0106
    title: tftp伺服器套件
    levels:
      - softwares
    notes: |-
      這項原則設定決定是否安裝tftp伺服器套件(tftp-server)
      tftp(Trivial File Transfer Protocol，簡單檔案傳輸協定)可 讓使用者在用戶端與伺服器之間使用tftp通訊協定來傳輸檔案。tftp通訊協定不支援任何身分鑑別或加密機制，將可能導致資料外洩
      移除tftp伺服器套件，以減少系統被攻擊面
    status: automated
    rules:
      - package_tftp-server_removed
  - id: TWGCB-01-012-0107
    title: 更新套件後移除舊版本元件
    levels:
      - softwares
    notes: |-
      這項原則設定決定系統更新套件後是否移除舊版本元件
      安裝更新後，若未從系統中移除舊版本元件，可能遭攻擊者利用舊版本元件漏洞進行攻擊
    status: automated
    rules:
      - clean_components_post_updating
  - id: TWGCB-01-012-0108
    title: IP轉送
    levels:
      - networking
    notes: "這項原則設定決定是否啟用IP轉送(Forwarding)功能\nIP轉送功能可在不同網卡之間傳遞封包，讓兩個網域可以互相溝通\nIP轉送功能一般實作在路由器上，擁有多網路介面之主機也可以實作\n\
      \t系統並非做為路由器，停用IP轉送功能，以提升網路安全性\n可設定之參數如下：\n0：表示停用IP轉送功能\n1：表示啟用IP轉送功能"
    status: automated
    rules:
      - sysctl_net_ipv4_ip_forward
      - sysctl_net_ipv6_conf_all_forwarding
  - id: TWGCB-01-012-0109
    title: 所有網路介面禁止傳送ICMP重新導向封包
    levels:
      - networking
    notes: |-
      這項原則設定決定所有網路介面是否允許傳送ICMP重新導向(Redirect)封包
      當路由器發現主機所選之路徑並非最佳路徑時，會送出ICMP重新導向封包，通知主機較佳之路徑
      系統並非做為路由器，停用ICMP重新導向功能，以提升網路安全性
      若啟用ICMP重新導向功能，攻擊者可利用已被入侵之主機發送惡意之ICMP重新導向封包給其他路由器，誘使其他主機連線至攻擊者所架設之假系統
      sysctl設定ICMP重新導向封包時，網路介面包含all與default兩種類型，all包含default，但設定時建議all與default都要進行設定
      可設定之參數如下：
      0：表示禁止傳送ICMP重新導向封包
      1：表示允許傳送ICMP重新導向封包
    status: automated
    rules:
      - sysctl_net_ipv4_conf_all_send_redirects
  - id: TWGCB-01-012-0110
    title: 預設網路介面禁止傳送ICMP重新導向封包
    levels:
      - networking
    notes: |-
      這項原則設定決定預設網路介面是否允許傳送ICMP重新導向(Redirect)封包
      當路由器發現主機所選之路徑並非最佳路徑時，會送出ICMP重新導向封包，通知主機較佳之路徑
      系統並非做為路由器，停用ICMP重新導向功能，以提升網路安全性
      若啟用ICMP重新導向功能，攻擊者可利用已被入侵之主機發送惡意之ICMP重新導向封包給其他路由器，誘使其他主機連線至攻擊者所架設之假系統
      sysctl設定ICMP重新導向封包時，網路介面包含all與default兩種類型，all包含default，但設定時建議all與default都要進行設定
      可設定之參數如下：
      0：表示禁止傳送ICMP重新導向封包
      1：表示允許傳送ICMP重新導向封包
    status: automated
    rules:
      - sysctl_net_ipv4_conf_default_send_redirects
  - id: TWGCB-01-012-0111
    title: 所有網路介面阻擋來源路由封包
    levels:
      - networking
    notes: |-
      這項原則設定決定所有網路介面是否接受來源路由封包
      來源路由(Source routing)可以用來指定一條從來源位址到目之位址之間之資料傳送路徑，阻擋來源路由封包，以防止封包偽裝(Packet Spoofing)攻擊
      可設定之參數如下：
      0：表示阻擋來源路由封包
      1：表示接受來源路由封包
    status: automated
    rules:
      - sysctl_net_ipv4_conf_all_accept_source_route
      - sysctl_net_ipv6_conf_all_accept_source_route
  - id: TWGCB-01-012-0112
    title: 預設網路介面阻擋來源路由封包
    levels:
      - networking
    notes: |-
      這項原則設定決定預設網路介面是否接受來源路由封包
      來源路由(Source routing)可以用來指定一條從來源位址到目之位址之間之資料傳送路徑，阻擋來源路由封包，以防止封包偽裝(Packet Spoofing)攻擊
      可設定之參數如下：
      0：表示阻擋來源路由封包
      1：表示接受來源路由封包
    status: automated
    rules:
      - sysctl_net_ipv4_conf_default_accept_source_route
      - sysctl_net_ipv6_conf_default_accept_source_route
  - id: TWGCB-01-012-0113
    title: 所有網路介面阻擋ICMP重新導向封包
    levels:
      - networking
    notes: |-
      這項原則設定決定所有網路介面是否接受ICMP重新導向封包
      ICMP重新導向封包是路由器用來通知主機更改路由表之工具，因此，攻擊者可透過此功能修改主機之路由表
      可設定之參數如下：
      0：表示阻擋ICMP重新導向封包
      1：表示接受ICMP重新導向封包
    status: automated
    rules:
      - sysctl_net_ipv4_conf_all_accept_redirects
      - sysctl_net_ipv6_conf_all_accept_redirects
  - id: TWGCB-01-012-0114
    title: 預設網路介面阻擋ICMP重新導向封包
    levels:
      - networking
    notes: |-
      這項原則設定決定預設網路介面是否接受ICMP重新導向封包
      ICMP重新導向封包是路由器用來通知主機更改路由表之工具，因此，攻擊者可透過此功能修改主機之路由表
      可設定之參數如下：
      0：表示阻擋ICMP重新導向封包
      1：表示接受ICMP重新導向封包
    status: automated
    rules:
      - sysctl_net_ipv4_conf_default_accept_redirects
      - sysctl_net_ipv6_conf_default_accept_redirects
  - id: TWGCB-01-012-0115
    title: 所有網路介面阻擋安全之ICMP重新導向封包
    levels:
      - networking
    notes: |-
      這項原則設定決定所有網路介面是否接受安全之ICMP重新導向封包
      安全ICMP重新導向僅接受已被列入受信任列表之閘道器所傳送之封包，但若在受信任列表中之閘道器被入侵變成惡意閘道器，將可能影響系統安全性
      可設定之參數如下：
      0：表示阻擋安全之ICMP重新導向封包
      1：表示接受安全之ICMP重新導向封包
    status: automated
    rules:
      - sysctl_net_ipv4_conf_all_secure_redirects
  - id: TWGCB-01-012-0116
    title: 預設網路介面阻擋安全之ICMP重新導向封包
    levels:
      - networking
    notes: |-
      這項原則設定決定預設網路介面是否接受安全之ICMP重新導向封包
      安全ICMP重新導向僅接受已被列入受信任列表之閘道器所傳送之封包，但若在受信任列表中之閘道器被入侵變成惡意閘道器，將可能影響系統安全性
      可設定之參數如下：
      0：表示阻擋安全之ICMP重新導向封包
      1：表示接受安全之ICMP重新導向封包
    status: automated
    rules:
      - sysctl_net_ipv4_conf_default_secure_redirects
  - id: TWGCB-01-012-0117
    title: 所有網路介面記錄可疑封包
    levels:
      - networking
    notes: |-
      這項原則設定決定所有網路介面是否記錄如偽造封包、來源路由封包或重新導向等可疑封包，以協助系統管理者早期發現系統遭受攻擊跡象
      可設定之參數如下：
      0：表示停用記錄可疑封包功能
      1：表示啟用記錄可疑封包功能
    status: automated
    rules:
      - sysctl_net_ipv4_conf_all_log_martians
  - id: TWGCB-01-012-0118
    title: 預設網路介面記錄可疑封包
    levels:
      - networking
    notes: |-
      這項原則設定決定預設網路介面是否記錄如偽造封包、來源路由封包或重新導向等可疑封包，以協助系統管理者早期發現系統遭受攻擊跡象
      可設定之參數如下：
      0：表示停用記錄可疑封包功能
      1：表示啟用記錄可疑封包功能
    status: automated
    rules:
      - sysctl_net_ipv4_conf_default_log_martians
  - id: TWGCB-01-012-0119
    title: 不回應ICMP廣播要求
    levels:
      - networking
    notes: |-
      這項原則設定決定是否不回應ICMP廣播要求，以防遭受ICMP攻擊
      當主機接收到ICMP echo-request封包時，若願意回應，則會送出echo-reply封包，攻擊者可利用此特性於ICMP封包假造來源為受害主機IP，並使用廣播傳送至網域，當網域內主機收到惡意之ICMP廣播封包後，送出echo-reply封包至受害主機，將導致受害主機可能無法提供服務
      可設定之參數如下：
      0：表示回應ICMP廣播要求
      1：表示不回應ICMP廣播要求
    status: automated
    rules:
      - sysctl_net_ipv4_icmp_echo_ignore_broadcasts
  - id: TWGCB-01-012-0120
    title: 忽略偽造之ICMP錯誤訊息
    levels:
      - networking
    notes: |-
      這項原則設定決定是否忽略偽造之ICMP錯誤訊息，以避免系統遭受ICMP攻擊
      惡意者在ICMP封包使用假來源位置，並使用廣播送出給網域內所有主機。當網域內主機沒有將此ICMP封包過濾，網域內主機將會傳送ICMP回應封包到受害主機，導致受害主機服務受到影響
      可設定之參數如下：
      0：表示回應偽造之ICMP錯誤訊息
      1：表示忽略偽造之ICMP錯誤訊息
    status: automated
    rules:
      - sysctl_net_ipv4_icmp_ignore_bogus_error_responses
  - id: TWGCB-01-012-0121
    title: 所有網路介面啟用逆向路徑過濾功能
    levels:
      - networking
    notes: |-
      這項原則設定決定所有網路介面是否啟用逆向路徑過濾(Reverse path filtering)功能
      逆向路徑過濾功能可針對所收到之封包，利用逆向路徑確認來源IP與所進入之網路介面設定是否相符，以判斷是否為合法封包，若不是合法封包將自動丟棄，以防止IP偽造(IP spoofing)攻擊
      可設定之參數如下：
      0：表示停用逆向路徑過濾功能
      1：表示啟用逆向路徑過濾功能
    status: automated
    rules:
      - sysctl_net_ipv4_conf_all_rp_filter
  - id: TWGCB-01-012-0122
    title: 預設網路介面啟用逆向路徑過濾功能
    levels:
      - networking
    notes: |-
      這項原則設定決定預設網路介面是否啟用逆向路徑過濾(Reverse path filtering)功能
      逆向路徑過濾功能可針對所收到之封包，利用逆向路徑確認來源IP與所進入之網路介面設定是否相符，以判斷是否為合法封包，若不是合法封包將自動丟棄，以防止IP偽造(IP spoofing)攻擊
      可設定之參數如下：
      0：表示停用逆向路徑過濾功能
      1：表示啟用逆向路徑過濾功能
    status: automated
    rules:
      - sysctl_net_ipv4_conf_default_rp_filter
  - id: TWGCB-01-012-0123
    title: TCP SYN cookies
    levels:
      - networking
    notes: |-
      這項原則設定決定是否啟用TCP SYN cookies功能
      啟用SYN Cookie 時，主機於發送SYN/ACK確認封包前，會要求Client端在短時間內回覆一個序號，此序號包含IP、port 等許多原本SYN封包內之資訊。若Client端可以回覆正確之序號，主機確定該封包可信任，則會發送SYN/ACK封包，否則不理會此一封包。透過此機制可避免SYN flood攻擊
      可設定之參數如下：
      0：表示停用TCP SYN cookies功能
      1：表示啟用TCP SYN cookies功能
    status: automated
    rules:
      - sysctl_net_ipv4_tcp_syncookies
  - id: TWGCB-01-012-0124
    title: 所有網路介面阻擋IPv6路由器公告訊息
    levels:
      - networking
    notes: |-
      這項原則設定決定所有網路介面是否接受IPv6路由器公告訊息
      IPv6路由器會定期在網路上傳送路由器公告訊息(Router Advertisement，RA)封包，RA封包透過ICMPv6進行傳送，系統接收到IPv6路由器發出之RA封包，即可得到IPv6位址
      接受IPv6路由器公告訊息，可能被誘騙將流量路由到已受害之電腦
      可設定之參數如下：
      0：表示阻擋IPv6路由器公告訊息
      1：表示接受IPv6路由器公告訊息
    status: automated
    rules:
      - sysctl_net_ipv6_conf_all_accept_ra
  - id: TWGCB-01-012-0125
    title: 預設網路介面阻擋IPv6路由器公告訊息
    levels:
      - networking
    notes: |-
      這項原則設定決定預設網路介面是否接受IPv6路由器公告訊息
      IPv6路由器會定期在網路上傳送路由器公告訊息(Router Advertisement，RA)封包，RA封包透過ICMPv6進行傳送，系統接收到IPv6路由器發出之RA封包，即可得到IPv6位址
      接受IPv6路由器公告訊息，可能被誘騙將流量路由到已受害之電腦
      可設定之參數如下：
      0：表示阻擋IPv6路由器公告訊息
      1：表示接受IPv6路由器公告訊息
    status: automated
    rules:
      - sysctl_net_ipv6_conf_default_accept_ra
  - id: TWGCB-01-012-0126
    title: DCCP協定
    levels:
      - networking
    notes: |-
      這項原則設定決定是否啟用DCCP協定
      DCCP協定(Datagram Congestion Control Protocol，封包壅塞控制協定)是一個擁有壅塞控制機制之非可靠式傳輸層網路通訊協定，其特性適合用於多媒體資料串流
      停用DCCP協定可減少系統被攻擊面
    status: automated
    rules:
      - kernel_module_dccp_disabled
  - id: TWGCB-01-012-0127
    title: SCTP協定
    levels:
      - networking
    notes: |-
      這項原則設定決定是否啟用SCTP協定
      SCTP協定(Stream Control Transmission Protocol，資料流控制傳輸協定)屬於傳輸層通訊協定，支援訊息導向通訊，並結合了TCP與UDP之特點，提高資料傳輸可靠性與效率
      停用此協定可減少系統被攻擊面
    status: automated
    rules:
      - kernel_module_sctp_disabled
  - id: TWGCB-01-012-0128
    title: RDS協定
    levels:
      - networking
    notes: |-
      這項原則設定決定是否啟用RDS協定
      RDS(Reliable Datagram Sockets)協定是由甲骨文(Oracle)發展之協定，提供節點與叢集間可靠之高效能與低延遲通訊，應用在VoIP網路電話
      停用此協定可減少系統被攻擊面
    status: automated
    rules:
      - kernel_module_rds_disabled
  - id: TWGCB-01-012-0129
    title: TIPC協定
    levels:
      - networking
    notes: |-
      這項原則設定決定是否啟用TIPC協定
      TIPC(Transparent Inter-Process Communication，透通處理程序間通訊)協定提供一個有效率之叢集式通訊協定，提高系統效能、可用性及擴展性
      停用此協定可減少系統被攻擊面
    status: automated
    rules:
      - kernel_module_tipc_disabled
  - id: TWGCB-01-012-0130
    title: 無線網路介面
    levels:
      - networking
    notes: |-
      這項原則設定決定是否停用無線網路介面
      若系統不透過無線網路進行連線與提供服務，應將無線網路介面設為停用，確保系統無法透過無線網路進行連線，以減少系統被攻擊面
    status: automated
    rules:
      - wireless_disable_interfaces
  - id: TWGCB-01-012-0131
    title: 網路介面混雜模式
    levels:
      - networking
    notes: |-
      這項原則設定決定是否啟用網路介面混雜模式
      網路介面若處於混雜模式(promiscuous mode)，即可接收所有經過該網路介面之網路封包
      停用網路介面混雜模式，以避免被攻擊者用於蒐集網路流量數據資料，其中可能包含登入帳號、通行碼及金鑰等機敏資訊
    status: automated
    rules:
      - network_sniffer_disabled
  - id: TWGCB-01-012-0132
    title: auditd套件
    levels:
      - logging
    notes: |-
      這項原則設定決定是否安裝auditd套件
      auditd為Linux系統使用之稽核工具套件，負責將稽核紀錄寫入磁碟予以保存
      運用稽核工具記錄系統事件，可供系統管理者判斷系統是否發生未經授權存取等異常行為
    status: automated
    rules:
      - package_audit-libs_installed
  - id: TWGCB-01-012-0133
    title: auditd服務
    levels:
      - logging
    notes: |-
      這項原則設定決定是否使用auditd服務
      啟用auditd服務記錄系統事件，可供系統管理者判斷系統是否發生未經授權存取等異常行為
    status: automated
    rules:
      - service_auditd_enabled
  - id: TWGCB-01-012-0134
    title: 稽核auditd服務啟動前之程序
    levels:
      - logging
    notes: |-
      這項原則設定決定是否針對auditd服務啟動前之程序(Process)進行稽核
      記錄auditd服務啟動前之程序(Process)所產生之事件，有助於發現潛在惡意行為
    status: automated
    rules:
      - grub2_audit_argument
  - id: TWGCB-01-012-0135
    title: 稽核待辦事項數量限制
    levels:
      - logging
    notes: |-
      這項原則設定決定是否設定稽核待辦事項數量限制
      稽核待辦事項數量限制(audit_backlog_limit)為設定開機過程中所建立稽核紀錄之保留數量限制，預設值為64
      設定audit_backlog_limit為8,192以上，以完整保留開機過程中所建立稽核紀錄，避免因稽核紀錄遺失導致無法發現潛在惡意行為
    status: automated
    rules:
      - grub2_audit_backlog_limit_argument
  - id: TWGCB-01-012-0136
    title: 稽核處理失敗時通知系統管理者
    levels:
      - logging
    notes: |-
      這項原則設定決定稽核處理失敗時是否通知系統管理者
      對於系統管理者而言，了解系統是否依設定處理稽核日誌至關重要，稽核處理失敗原因包含軟體或硬體出錯，以及稽核日誌儲存磁碟空間異常等情況
      啟用此通知讓系統管理者得知系統稽核功能異常並儘速處理，避免因稽核功能異常導致無法發現潛在惡意行為
    status: automated
    rules:
      - postfix_client_configure_mail_alias_postmaster
  - id: TWGCB-01-012-0137
    title: 稽核日誌檔案所有權
    levels:
      - logging
    notes: |-
      這項原則設定決定是否設定稽核日誌檔案之所有權
      稽核日誌檔案包含系統之稽核紀錄、稽核設定及稽核結果等資訊
      設定稽核日誌檔案所有權，避免因未經授權存取而洩露稽核記錄，讓攻擊者取得系統與組態設定等機敏資訊
    status: automated
    rules:
      - file_group_ownership_var_log_audit
      - file_ownership_var_log_audit
  - id: TWGCB-01-012-0138
    title: 稽核日誌檔案權限
    levels:
      - logging
    notes: |-
      這項原則設定決定是否設定稽核日誌檔案之權限
      稽核日誌檔案包含系統之稽核紀錄、稽核設定及稽核結果等資訊
      設定稽核日誌檔案權限，避免因未經授權存取而洩露稽核記錄，讓攻擊者取得系統與組態設定等機敏資訊
    status: automated
    rules:
      - file_permissions_var_log_audit
  - id: TWGCB-01-012-0139
    title: 稽核日誌目錄所有權
    levels:
      - logging
    notes: |-
      這項原則設定決定是否設定稽核日誌目錄所有權
      稽核日誌目錄存有稽核日誌檔案，該檔案包含系統之稽核紀錄、稽核設定及稽核結果等資訊
      設定稽核日誌目錄所有權，避免因未經授權存取而洩露稽核紀錄，遭攻擊者取得系統與組態設定等機敏資訊
    status: automated
    rules:
      - directory_group_ownership_var_log_audit
      - directory_ownership_var_log_audit
  - id: TWGCB-01-012-0140
    title: 稽核日誌目錄權限
    levels:
      - logging
    notes: |-
      這項原則設定決定是否設定稽核日誌目錄之權限
      稽核日誌目錄存有稽核日誌檔案，該檔案包含系統之稽核紀錄、稽核設定及稽核結果等資訊
      設定稽核日誌目錄權限，避免因未經授權存取而洩露稽核紀錄，遭攻擊者取得系統與組態設定等機敏資訊
    status: automated
    rules:
      - directory_permissions_var_log_audit
  - id: TWGCB-01-012-0141
    title: 稽核規則檔案權限
    levels:
      - logging
    notes: |-
      這項原則設定決定是否設定稽核規則檔案權限
      系統管理者應設定要稽核之事件，因錯誤之稽核設定會導致稽核系統負擔過重，進而降低系統效能，並使負責調查與分析資安事件之人員作業更加困難
      設定稽核規則檔案權限，避免未經授權人員修改稽核規則，導致遺失重要稽核紀錄
    status: automated
    rules:
      - file_groupownership_audit_configuration
      - file_ownership_audit_configuration
  - id: TWGCB-01-012-0142
    title: 稽核設定檔案權限
    levels:
      - logging
    notes: |-
      這項原則設定決定是否設定稽核設定檔案權限
      系統管理者應設定要稽核之事件，因錯誤之稽核設定會導致稽核系統負擔過重，進而降低系統效能，並使負責調查與分析資安事件之人員作業更加困難
      設定稽核設定檔案權限，避免未經授權人員修改稽核設定，導致遺失重要稽核紀錄
    status: automated
    rules:
      - file_permissions_audit_configuration
  - id: TWGCB-01-012-0143
    title: 稽核工具權限
    levels:
      - logging
    notes: |-
      這項原則設定決定是否設定稽核工具權限
      稽核工具可用以查看日誌資料、操作稽核系統及記錄稽核資訊，以及自訂查詢與產生報告
      設定稽核工具權限，避免稽核紀錄遭未經授權修改
    status: automated
    rules:
      - file_permissions_audit_binaries
  - id: TWGCB-01-012-0144
    title: 稽核工具所有權
    levels:
      - logging
    notes: |-
      這項原則設定決定是否設定稽核工具所有權
      稽核工具可用以查看日誌資料、操作稽核系統及記錄稽核資訊，以及自訂查詢與產生報告
      設定稽核工具所有權，避免稽核紀錄遭未經授權修改
    status: automated
    rules:
      - file_groupownership_audit_binaries
      - file_ownership_audit_binaries
  - id: TWGCB-01-012-0145
    title: 保護稽核工具
    levels:
      - logging
    notes: |-
      這項原則設定決定是否啟用稽核工具保護功能，以保護稽核工具之完整性
      稽核工具可用以查看日誌資料、操作稽核系統及記錄稽核資訊，以及自訂查詢與產生報告
      保護稽核工具之完整性，避免稽核工具被攻擊者替換或竄改，以降低稽核紀錄被竄改之風險
    status: automated
    rules:
      - aide_check_audit_tools
  - id: TWGCB-01-012-0146
    title: 稽核日誌檔案大小上限
    levels:
      - logging
    notes: |-
      這項原則設定決定是否設定稽核日誌檔案大小上限
      max_log_file參數可設定稽核日誌檔案大小上限值(MB)，以避免影響系統運作與遺失稽核紀錄
    status: automated
    rules:
      - auditd_data_retention_max_log_file
      - var_auditd_max_log_file=32
  - id: TWGCB-01-012-0147
    title: 稽核日誌達到其檔案大小上限之行為
    levels:
      - logging
    notes: |-
      這項原則設定決定是否設定稽核日誌達到其檔案大小上限之行為
      max_log_file_action參數可設定稽核日誌檔案達到檔案大小上限時，系統要如何處理稽核日誌檔案，將參數設為keep_logs，則系統將輪替日誌，且不會刪除舊日誌
      注意：請定期備份日誌檔案，以及清理與維護系統磁碟空間，以確保有足夠空間可保存稽核日誌檔案
    status: automated
    rules:
      - auditd_data_retention_max_log_file_action
      - var_auditd_max_log_file_action=keep_logs
  - id: TWGCB-01-012-0148
    title: 記錄系統管理者活動
    levels:
      - logging
    notes: |-
      這項原則設定決定是否記錄系統管理者活動
      /etc/sudoers檔案為sudo套件之預設設定檔，可設定授予使用者帳號之權限，當使用者執行sudo時，系統會自動根據/etc/sudoers檔案，判斷該使用者是否具有執行sudo之權限
      當/etc/sudoers檔案變更或檔案屬性變更時，將記錄至稽核紀錄中，並標記為「scope」，以及早發現未經授權之行為
    status: automated
    rules:
      - audit_rules_sudoers
      - audit_rules_sudoers_d
  - id: TWGCB-01-012-0149
    title: 記錄變更登入與登出資訊事件
    levels:
      - logging
    notes: |-
      這項原則設定決定是否記錄變更登入與登出資訊之事件
      下列為登入與登出資訊相關檔案，若遭非預期變更代表系統可能已被入侵、入侵者想要隱藏蹤跡或入侵其他使用者帳號：
      /var/run/faillock/：此目錄保存登入失敗紀錄
      /var/log/lastlog：記錄使用者最近一次成功登入
      建議系統記錄變更登入與登出資訊之事件於/var/log/audit/audit.log，並標記為「logins」，以監控登入與登出行為
    status: automated
    rules:
      - audit_rules_login_events_faillock
      - audit_rules_login_events_lastlog
      - var_accounts_passwords_pam_faillock_dir=run
  - id: TWGCB-01-012-0150
    title: 記錄會談啟始資訊
    levels:
      - logging
    notes: |-
      這項原則設定決定是否記錄變更會談(Session)啟始資訊之事件
      下列為會談啟始資訊相關檔案，包含所有使用者登入、登出、重新開機或關機等資訊
      /var/run/utmp：記錄目前登入到系統之使用者訊息
      /var/log/wtmp：記錄登入、登出、重新開機及關機等資訊
      /var/log/btmp：記錄錯誤之登入嘗試
      建議系統記錄變更所有使用者登入、登出、重新開機或關機等資訊之事件，並標記為「session」或「logins」，以監控會談啟始資訊相關檔案之變更
    status: automated
    rules:
      - audit_rules_session_events_btmp
      - audit_rules_session_events_utmp
      - audit_rules_session_events_wtmp
  - id: TWGCB-01-012-0151
    title: 記錄變更日期與時間事件
    levels:
      - logging
    notes: |-
      這項原則設定決定是否記錄變更日期或時間資訊之事件
      下列為系統日期與時間相關參數：
      adjtimex：調整系統核心時間
      settimeofday：以時區方式設定系統時間
      stime：以秒為單位設定系統時間(從1970年1月1日到現在之秒數)
      clock_settime：設定內部時鐘與計時器
      建議系統記錄包含adjtimex、settimeofday、stime及clock_settime等系統呼叫(System calls)進行日期與時間變更之事件於/var/log/audit.log檔案中，並標記為「time-change」
      非預期之系統日期與時間變更，可能為惡意活動跡象，有助於發現異常行為
    status: automated
    rules:
      - audit_rules_time_adjtimex
      - audit_rules_time_settimeofday
      - audit_rules_time_stime
      - audit_rules_time_clock_settime
      - audit_rules_time_watch_localtime
  - id: TWGCB-01-012-0152
    title: 記錄變更系統強制存取控制事件
    levels:
      - logging
    notes: |-
      這項原則設定決定是否記錄變更系統強制存取控制(Mandatory access controls)事件，包含/etc/selinux與/usr/share/selinux/目錄屬性變更，以及在目錄內新增、刪除或修改檔案之事件
      當/etc/selinux與/usr/share/selinux/目錄屬性或檔案遭非預期變更，代表未授權使用者嘗試變更存取控制或改變安全設定，將可能導致系統被入侵，應進行記錄，並標記為「MAC-policy」
    status: automated
    rules:
      - audit_rules_mac_modification
  - id: TWGCB-01-012-0153
    title: 記錄變更系統網路環境事件
    levels:
      - logging
    notes: |-
      這項原則設定決定是否記錄變更系統網路環境之事件
      當主機名稱與網域名稱變更時，將可能破壞以這2個參數為基礎之安全設定
      /etc/hosts定義主機名稱與IP位置對應檔案，入侵者可變更此檔案將連線導至其他主機
      入侵者可利用/etc/issue與/etc/issue.net放置錯誤訊息登入畫面，誘騙使用者提供資訊給入侵者
      /etc/sysconfig/network-scripts/目錄包含網路介面腳本與設定檔，當入侵者變更目錄內之檔案，可能導至服務中斷或系統資訊洩漏
      當/etc/issue、/etc/issue.net、 /etc/hosts及/etc/sysconfig/network-scripts/等檔案被變更時，以及使用sethostname與setdomainname可變更名稱之系統呼叫，應進行記錄並標記為「system-locale」
    status: automated
    rules:
      - audit_rules_networkconfig_modification
  - id: TWGCB-01-012-0154
    title: 記錄變更自主存取控制權限事件
    levels:
      - logging
    notes: |-
      這項原則設定決定是否記錄變更自主存取控制(Discretionary access control)權限之事件
      記錄變更檔案權限(例如：chmod、fchmod及fchmodat)、檔案延伸屬性(例如：setxattr、lsetxattr、fsetxattr、removexattr、lremovexattr及fremovexattr)、擁有者及擁有群組(例如：chown、fchown、fchownat及lchown)之事件
      稽核紀錄僅記錄系統使用者(auid>=1000，並忽略守護程序auid=4294967295)所產生之事件，並標記為「perm_mod」
      監控檔案屬性之變更，可為系統管理者提供入侵者跡象或違反原則行為
      設定時，如系統曾變更UID_MIN參數，請執行下列指令取得UID_MIN數值，並將auid>=1000調整為auid>=UID_MIN數值：
      awk '/^\s*UID_MIN/{print $2}' /etc/login.defs
    status: automated
    rules:
      - audit_rules_successful_file_modification_chmod
      - audit_rules_successful_file_modification_chown
      - audit_rules_successful_file_modification_fchmod
      - audit_rules_successful_file_modification_fchmodat
      - audit_rules_successful_file_modification_fchown
      - audit_rules_successful_file_modification_fchownat
      - audit_rules_successful_file_modification_fremovexattr
      - audit_rules_successful_file_modification_fsetxattr
      - audit_rules_successful_file_modification_lchown
      - audit_rules_successful_file_modification_lremovexattr
      - audit_rules_successful_file_modification_lsetxattr
      - audit_rules_successful_file_modification_removexattr
      - audit_rules_successful_file_modification_setxattr
      - audit_rules_unsuccessful_file_modification_chmod
      - audit_rules_unsuccessful_file_modification_chown
      - audit_rules_unsuccessful_file_modification_fchmod
      - audit_rules_unsuccessful_file_modification_fchmodat
      - audit_rules_unsuccessful_file_modification_fchown
      - audit_rules_unsuccessful_file_modification_fchownat
      - audit_rules_unsuccessful_file_modification_fremovexattr
      - audit_rules_unsuccessful_file_modification_fsetxattr
      - audit_rules_unsuccessful_file_modification_lchown
      - audit_rules_unsuccessful_file_modification_lremovexattr
      - audit_rules_unsuccessful_file_modification_lsetxattr
      - audit_rules_unsuccessful_file_modification_removexattr
      - audit_rules_unsuccessful_file_modification_setxattr
  - id: TWGCB-01-012-0155
    title: 記錄不成功之未經授權檔案存取
    levels:
      - logging
    notes: |-
      這項原則設定決定是否記錄所有使用者未經授權存取檔案之行為
      建議設定系統監控包含控制建立(creat)、開啟(open、openat)及截斷(truncate、ftruncate)等系統呼叫存取檔案之行為，並針對系統使用者(auid>=1000，並忽略守護程序auid=4294967295)，且顯示對此檔案無權限(EACCES)或系統呼叫參數錯誤(EPERM)等事件進行記錄，並標記為「access」
      開啟、建立或截斷檔案之失敗嘗試，代表可能有使用者或程序試圖對系統進行未授權存取
      設定時，如系統曾變更UID_MIN參數，請執行下列指令取得UID_MIN數值，並將auid>=1000調整為auid>=UID_MIN數值：
      awk '/^\s*UID_MIN/{print $2}' /etc/login.defs
    status: automated
    rules:
      - audit_rules_unsuccessful_file_modification_ftruncate
      - audit_rules_unsuccessful_file_modification_open
      - audit_rules_unsuccessful_file_modification_openat
      - audit_rules_unsuccessful_file_modification_truncate
  - id: TWGCB-01-012-0156
    title: 記錄變更使用者或群組資訊事件
    levels:
      - logging
    notes: |-
      這項原則設定決定是否記錄變更使用者或群組資訊之事件
      當/etc目錄下group、passwd、gshadow、shadow及opasswd等檔案被修改或變更檔案屬性(例如權限)時，應進行記錄並標記為「identity」
      此類檔案遭非預期變更，代表系統可能已被入侵，或入侵者想要隱藏蹤跡，或入侵其他使用者帳號
    status: automated
    rules:
      - audit_rules_usergroup_modification
  - id: TWGCB-01-012-0157
    title: 記錄變更檔案系統掛載事件
    levels:
      - logging
    notes: |-
      這項原則設定決定是否記錄檔案系統掛載之事件
      對於非系統管理者而言，將檔案系統掛載到系統為異常行為，潛在有資料未經授權匯出至外部儲存裝置之風險
      建議設定系統監控mount與umount系統呼叫檔案系統掛載之行為，針對系統使用者(auid>=1000，並忽略守護程序auid=4294967295)所產生之事件，並標記為「mounts」
      設定時，如系統曾變更UID_MIN參數，請執行下列指令取得UID_MIN數值，並將auid>=1000調整為auid>=UID_MIN數值：
      awk '/^\s*UID_MIN/{print $2}' /etc/login.defs
    status: automated
    rules:
      - audit_rules_media_export
  - id: TWGCB-01-012-0158
    title: 記錄特權指令使用情形
    levels:
      - logging
    notes: |-
      這項原則設定決定是否記錄特權指令使用情形
      特權指令是指具有setuid或setgid特權之程式，任何人執行該程式時，會以該程式之擁有者身分執行，藉由短暫提權讓一般使用者存取未被授權之檔案。因此須監控特權指令使用狀況，以及早發現使用者非法存取未授權資源之情形
      建議系統監控與記錄系統使用者(auid>=1000，並忽略守護程序auid=4294967295)使用特權指令所產生之事件，並標記為「privileged」
      設定時，如系統曾變更UID_MIN參數，請執行下列指令取得UID_MIN數值，並將auid>=1000調整為auid>=UID_MIN數值：
      awk '/^\s*UID_MIN/{print $2}' /etc/login.defs
    status: automated
    rules:
      - audit_rules_privileged_commands
  - id: TWGCB-01-012-0159
    title: 記錄檔案刪除事件
    levels:
      - logging
    notes: |-
      這項原則設定決定是否蒐集使用者利用unlink、unlinkat、rename或renameat等系統呼叫進行刪除檔案、移除檔案屬性、更換檔名或路徑等事件
      unlink：刪除檔案
      unlinkat：刪除檔案或目錄
      rename：變更檔名
      renameat：變更檔名或路徑
      rmdir：刪除空資料夾
      建議系統監控並記錄系統使用者(auid>=1000，並忽略守護程序auid=4294967295)所產生之事件，並標記為「delete」
      設定時，如系統曾變更UID_MIN參數，請執行下列指令取得UID_MIN數值，並將auid>=1000調整為auid>=UID_MIN數值：
      awk '/^\s*UID_MIN/{print $2}' /etc/login.defs
    status: automated
    rules:
      - audit_rules_successful_file_modification_rename
      - audit_rules_successful_file_modification_renameat
      - audit_rules_successful_file_modification_unlink
      - audit_rules_successful_file_modification_unlinkat
      - audit_rules_unsuccessful_file_modification_rename
      - audit_rules_unsuccessful_file_modification_renameat
      - audit_rules_unsuccessful_file_modification_unlink
      - audit_rules_unsuccessful_file_modification_unlinkat
  - id: TWGCB-01-012-0160
    title: 記錄核心模組掛載與卸載事件
    levels:
      - logging
    notes: |-
      這項原則設定決定是否記錄核心模組掛載與卸載事件
      核心模組掛載與卸載事件包含安裝核心模組(insmod)、移除核心模組(rmmod)、控制載入與卸載核心模組(modprobe)、掛載模組(init_module)及刪除模組( delete_module)，以及init_module與delete_module系統呼叫可用於起其他程序掛載與卸載核心模組
      建議系統監控與記錄核心模組掛載與卸載事件，並標記為「modules」
      核心模組掛載與卸載事件紀錄反映系統有未經授權之使用者掛載與卸載核心模組，可能損害系統安全性
    status: automated
    rules:
      - audit_rules_kernel_module_loading_delete
      - audit_rules_kernel_module_loading_init
      - audit_rules_privileged_commands_insmod
      - audit_rules_privileged_commands_rmmod
      - audit_rules_privileged_commands_modprobe
  - id: TWGCB-01-012-0161
    title: 記錄系統管理者活動日誌變更
    levels:
      - logging
    notes: |-
      這項原則設定決定是否記錄系統管理者活動日誌(sudo.log)變更之事件
      當使用者以sudo執行特權指令，系統會自動根據/etc/sudoers檔案，判斷該使用者是否具有執行sudo之權限，並將所有管理者指令都記錄到/var/log/sudo.log
      建議系統監控與記錄/var/log/sudo.log檔案寫入狀況或屬性變更情形，並標記為「actions」
      /var/log/sudo.log檔案若遭修改，代表系統管理員已執行sudo指令，或是檔案遭未經授權竄改
      系統管理者可將稽核事件與/var/log/sudo.log紀錄內容進行比對，以驗證是否有未經授權指令被執行
    status: automated
    rules:
      - audit_sudo_log_events
    related_rules:
      - sudo_custom_logfile
  - id: TWGCB-01-012-0162
    title: 記錄chcon指令使用情形
    levels:
      - logging
    notes: |-
      這項原則設定決定是否記錄chcon指令使用情形
      chcon指令用於更改檔案之SELinux安全性本文(security context)，建立使用系統重要指令、程序或系統呼叫之稽核紀錄，可提供系統管理者用於調查與分析資安事件
      建議系統監控與記錄系統使用者(auid>=1000，並忽略守護程序auid=4294967295)使用chcon指令所產生之事件，並標記為「perm_chng」
      設定時，如系統曾變更UID_MIN參數，請執行下列指令取得UID_MIN數值，並將auid>=1000調整為auid>=UID_MIN數值：
      awk '/^\s*UID_MIN/{print $2}' /etc/login.defs
    status: automated
    rules:
      - audit_rules_execution_chcon
  - id: TWGCB-01-012-0163
    title: 記錄ssh-agent程序使用情形
    levels:
      - logging
    notes: |-
      這項原則設定決定是否記錄ssh-agent程序使用情形
      ssh-agent程序用於保存驗證公鑰所使用之私鑰，建立使用系統重要指令、程序或系統呼叫之稽核紀錄，可提供系統管理者用於調查與分析資安事件
      建議系統監控與記錄系統使用者(auid>=1000，並忽略守護程序auid=4294967295)使用ssh-agent程序所產生之事件，並標記為「privileged-ssh」
      設定時，如系統曾變更UID_MIN參數，請執行下列指令取得UID_MIN數值，並將auid>=1000調整為auid>=UID_MIN數值：
      awk '/^\s*UID_MIN/{print $2}' /etc/login.defs
    status: automated
    rules:
      - audit_rules_privileged_commands_ssh_agent
  - id: TWGCB-01-012-0164
    title: 記錄unix_update程序使用情形
    levels:
      - logging
    notes: |-
      這項原則設定決定是否記錄unix_update程序使用情形
      unix_update程序是pam_unix模組之輔助程序，用於更新使用者通行碼，建立使用系統重要指令、程序或系統呼叫之稽核紀錄，可提供系統管理者用於調查與分析資安事件
      建議系統監控與記錄系統使用者(auid>=1000，並忽略守護程序auid=4294967295)使用unix_update程序所產生之事件，並標記為「privileged-unix-update」
      設定時，如系統曾變更UID_MIN參數，請執行下列指令取得UID_MIN數值，並將auid>=1000調整為auid>=UID_MIN數值：
      awk '/^\s*UID_MIN/{print $2}' /etc/login.defs
    status: automated
    rules:
      - audit_rules_privileged_commands_unix_update
  - id: TWGCB-01-012-0165
    title: 記錄setfacl指令使用情形
    levels:
      - logging
    notes: |-
      這項原則設定決定是否記錄setfacl指令使用情形
      setfacl指令用於設定檔案之存取控制表(ACL)，建立使用系統重要指令、程序或系統呼叫之稽核紀錄，可提供系統管理者用於調查與分析資安事件
      建議系統監控與記錄系統使用者(auid>=1000，並忽略守護程序auid=4294967295)使用setfacl指令所產生之事件，並標記為「perm_chng」
      設定時，如系統曾變更UID_MIN參數，請執行下列指令取得UID_MIN數值，並將auid>=1000調整為auid>=UID_MIN數值：
      awk '/^\s*UID_MIN/{print $2}' /etc/login.defs
    status: automated
    rules:
      - audit_rules_execution_setfacl
  - id: TWGCB-01-012-0166
    title: 記錄finit_module指令使用情形
    levels:
      - logging
    notes: |-
      這項原則設定決定是否記錄finit_module指令使用情形
      finit_module指令用於載入核心模組，建立使用系統重要指令、程序或系統呼叫之稽核紀錄，可提供系統管理者用於調查與分析資安事件
      建議系統監控與記錄系統使用者(auid>=1000，並忽略守護程序auid=4294967295)使用finit_module指令所產生之事件，並標記為「module_chng」
      設定時，如系統曾變更UID_MIN參數，請執行下列指令取得UID_MIN數值，並將auid>=1000調整為auid>=UID_MIN數值：
      awk '/^\s*UID_MIN/{print $2}' /etc/login.defs
    status: automated
    rules:
      - audit_rules_kernel_module_loading_finit
  - id: TWGCB-01-012-0167
    title: 記錄open_by_handle_at系統呼叫使用情形
    levels:
      - logging
    notes: |-
      這項原則設定決定是否記錄open_by_handle_at系統呼叫使用情形
      open_by_handle_at系統呼叫可透過檔案描述符(File descriptor)開啟所指定之檔案，建立使用系統重要指令、程序或系統呼叫之稽核紀錄，可提供系統管理者用於調查與分析資安事件
      建議系統監控與記錄系統使用者(auid>=1000，並忽略守護程序auid=4294967295)使用open_by_handle_at系統呼叫所產生之事件，並標記為「perm_access」
      設定時，如系統曾變更UID_MIN參數，請執行下列指令取得UID_MIN數值，並將auid>=1000調整為auid>=UID_MIN數值：
      awk '/^\s*UID_MIN/{print $2}' /etc/login.defs
    status: automated
    rules:
      - audit_rules_unsuccessful_file_modification_open_by_handle_at
  - id: TWGCB-01-012-0168
    title: 記錄usermod指令使用情形
    levels:
      - logging
    notes: |-
      這項原則設定決定是否記錄usermod指令使用情形
      usermod指令可用於修改使用者帳號設定，建立使用系統重要指令、程序或系統呼叫之稽核紀錄，可提供系統管理者用於調查與分析資安事件
      建議系統監控與記錄系統使用者(auid>=1000，並忽略守護程序auid=4294967295)使用usermod指令所產生之事件，並標記為「privileged-usermod」
      設定時，如系統曾變更UID_MIN參數，請執行下列指令取得UID_MIN數值，並將auid>=1000調整為auid>=UID_MIN數值：
      awk '/^\s*UID_MIN/{print $2}' /etc/login.defs
    status: automated
    rules:
      - audit_rules_privileged_commands_usermod
  - id: TWGCB-01-012-0169
    title: 記錄chacl指令使用情形
    levels:
      - logging
    notes: |-
      這項原則設定決定是否記錄chacl指令使用情形
      chacl指令用於更改檔案或目錄之存取控制表(ACL)，建立使用系統重要指令、程序或系統呼叫之稽核紀錄，可提供系統管理者用於調查與分析資安事件
      建議系統監控與記錄系統使用者(auid>=1000，並忽略守護程序auid=4294967295)使用chacl指令指令所產生之事件，並標記為「perm_chng」
      設定時，如系統曾變更UID_MIN參數，請執行下列指令取得UID_MIN數值，並將auid>=1000調整為auid>=UID_MIN數值：
      awk '/^\s*UID_MIN/{print $2}' /etc/login.defs
    status: automated
    rules:
      - audit_rules_execution_chacl
  - id: TWGCB-01-012-0170
    title: 記錄kmod指令使用情形
    levels:
      - logging
    notes: |-
      這項原則設定決定是否記錄kmod指令使用情形
      kmod指令用於控制Linux核心模組，建立使用系統重要指令、程序或系統呼叫之稽核紀錄，可提供系統管理者用於調查與分析資安事件
      建議系統監控與記錄使用kmod指令所產生之事件，並標記為「modules」
    status: automated
    rules:
      - audit_rules_privileged_commands_kmod
  - id: TWGCB-01-012-0171
    title: 記錄Pam_Faillock日誌檔案
    levels:
      - logging
    notes: |-
      這項原則設定決定是否記錄Pam_Faillock日誌檔案
      Pam_Faillock用於指定之時間間隔內對帳號認證失敗進行計數與鎖定，並將登入嘗試失敗之資料儲存在日誌檔案，建立使用系統重要指令、程序或系統呼叫之稽核紀錄，可提供系統管理者用於調查與分析資安事件
      建議系統監控與記錄Pam_Faillock日誌檔案，並標記為「logins」
    status: automated
    rules:
      - audit_rules_login_events_faillock
      - var_accounts_passwords_pam_faillock_dir=default
  - id: TWGCB-01-012-0172
    title: 記錄execve系統呼叫使用情形
    levels:
      - logging
    notes: |-
      這項原則設定決定是否記錄execve系統呼叫使用情形
      execve系統呼叫可建立新程序取代執行中之程序並保持相同PID(Process ID)，建立使用系統重要指令、程序或系統呼叫之稽核紀錄，可提供系統管理者用於調查與分析資安事件
      建議系統監控與記錄execve系統呼叫使用情形並忽略守護程序auid=unset，以避免程序使用比使用者更高權限執行而產生安全漏洞
    status: automated
    rules:
      - audit_rules_suid_privilege_function
  - id: TWGCB-01-012-0173
    title: auditd設定不變模式
    levels:
      - logging
    notes: "這項原則設定決定是否啟用auditd設定不變模式(Immutable mode)\n如果設為不變模式，使用者即使使用auditctl指令變更稽核規則，新稽核規則不會立即作用，必須重新開機後才能生效\n\
      設為不變模式後，任何稽核規則變更必須重新開機後才會生效，藉此可防止惡意使用者利用變更稽核規則來隱藏惡意活動，亦可協助系統管理者藉由觀察非預期之重新開機，研判系統是否存在惡意活動\n\
      「-e」可設定參數如下；\n設為0：停用稽核\n設為1：啟用稽核\n設為2：稽核設定不變模式\n\t「--loginuid-immutable」，代表一旦loginuid被設定之後就無法被變更，這可能使得某些容器(container)無法正常運作"
    status: automated
    rules:
      - audit_rules_immutable
      - audit_rules_immutable_login_uids
  - id: TWGCB-01-012-0174
    title: rsyslog套件
    levels:
      - logging
    notes: |-
      這項原則設定決定是否安裝rsyslog套件
      rsyslog為系統公用程式，提供系統資訊記錄功能，支援本機端日誌紀錄，並以加密傳輸方式發送日誌紀錄至遠端伺服器，以及可用資料庫儲存日誌紀錄
      安裝rsyslog套件，為系統日誌管理提供更完備之功能
    status: automated
    rules:
      - package_rsyslog_installed
  - id: TWGCB-01-012-0175
    title: rsyslog服務
    levels:
      - logging
    notes: |-
      這項原則設定決定是否啟用rsyslog服務
      rsyslog為系統公用程式，提供系統資訊記錄功能，支援本機端日誌紀錄，並以加密傳輸方式發送日誌紀錄至遠端伺服器，以及可用資料庫儲存日誌紀錄
      啟用rsyslog服務，為系統日誌管理提供更完備之功能
    status: automated
    rules:
      - service_rsyslog_enabled
  - id: TWGCB-01-012-0176
    title: 設定rsyslog日誌檔案預設權限
    levels:
      - logging
    notes: |-
      這項原則決定是否設定rsyslog日誌檔案預設權限
      rsyslog在有需求時會為系統建立新日誌檔案，「$FileCreateMode」參數用於控制新增日誌檔案之預設權限
      為日誌檔案設定預設權限，以保護系統機敏資料
    status: automated
    rules:
      - rsyslog_filecreatemode
  - id: TWGCB-01-012-0177
    title: 設定rsyslog日誌記錄規則
    levels:
      - logging
    notes: |-
      這項原則決定是否設定rsyslog日誌記錄規則，以記錄認證、授權及系統服務等重要系統資訊
      /etc/rsyslog.conf與/etc/rsyslog.d/*.conf檔案可設定日誌記錄規則，以及將指定之類別資訊儲存至日誌檔案
      啟用rsyslog保存認證、授權及系統服務日誌，以供系統管理者監控是否有未經授權存取行為
    status: automated
    rules:
      - rsyslog_logging_configured
  - id: TWGCB-01-012-0178
    title: /var/log/messages檔案所有權
    levels:
      - logging
    notes: |-
      這項原則設定決定是否設定/var/log/messages檔案所有權
      當系統出現錯誤，例如系統資源耗盡與核心活動發生錯誤等事件發生，將會記錄到/var/log/messages檔案
      設定/var/log/messages檔案所有權為系統管理者，避免因未經授權存取而洩露機敏資訊
    status: automated
    rules:
      - file_groupowner_var_log_messages
      - file_owner_var_log_messages
  - id: TWGCB-01-012-0179
    title: /var/log目錄所有權
    levels:
      - logging
    notes: |-
      這項原則設定決定是否設定/var/log目錄所有權
      當系統出現錯誤，例如系統資源耗盡與核心活動發生錯誤等事件發生，將會記錄到/var/log/messages檔案
      設定/var/log目錄所有權為系統管理者，避免因未經授權存取而洩露機敏資訊
    status: automated
    rules:
      - file_groupowner_var_log
      - file_owner_var_log
  - id: TWGCB-01-012-0180
    title: 設定journald將日誌發送到rsyslog
    levels:
      - logging
    notes: |-
      這項原則設定決定是否設定journald將日誌發送到rsyslog
      systemd是Linux系統設定管理程式，並提供journald做為自身之日誌系統，journald之資料可以暫存於記憶體或永久保存在伺服器上，並允許將日誌從journald匯出至rsyslog
      啟用journald將日誌發送到rsyslog，以透過rsyslog服務提供一致性之日誌保存方式
    status: automated
    rules:
      - journald_forward_to_syslog
  - id: TWGCB-01-012-0181
    title: 設定journald壓縮日誌檔案
    levels:
      - logging
    notes: |-
      這項原則設定決定是否設定journald壓縮日誌檔案
      systemd是Linux系統設定管理程式，並提供journald做為自身之日誌系統，journald之資料可以暫存於記憶體或永久保存在伺服器上，並允許將日誌從journald匯出至rsyslog
      journald可壓縮過大日誌檔案，啟用此功能可避免日誌檔案占用空間與資源，導致系統異常
    status: automated
    rules:
      - journald_compress
  - id: TWGCB-01-012-0182
    title: 設定journald將日誌檔案永久保存於磁碟
    levels:
      - logging
    notes: |-
      這項原則設定決定是否設定journald將日誌檔案永久保存於磁碟
      systemd是Linux系統設定管理程式，並提供journald做為自身之日誌系統，journald之資料可以暫存於記憶體或永久保存在伺服器上，並允許將日誌從journald匯出至rsyslog
      設定將日誌檔案永久保存於磁諜中，可提供系統管理者分析資安事件發生原因
    status: automated
    rules:
      - journald_storage
  - id: TWGCB-01-012-0183
    title: SELinux套件
    levels:
      - selinux
    notes: |-
      這項原則設定決定是否安裝SELinux(Security-Enhanced Linux，安全增強Linux)套件
      SELinux是一個Linux核心安全模組，提供強制存取控制(MAC)安全性原則，可強制Linux系統中的檔案與程序依據定義的原則限制存取行為，啟用SELinux有助於提升伺服器安全性
    status: automated
    rules:
      - package_libselinux_installed
  - id: TWGCB-01-012-0184
    title: 開機載入程式啟用SELinux
    levels:
      - selinux
    notes: |-
      這項原則設定決定是否在開機載入程式中啟用SELinux
      在開機載入程式中啟用SELinux，確保SELinux正常運作，以提升伺服器安全性
    status: automated
    rules:
      - grub2_enable_selinux
  - id: TWGCB-01-012-0185
    title: SELinux政策
    levels:
      - selinux
    notes: |-
      這項原則設定決定SELinux運作時所採用之政策
      設定SELinux使用預設之targeted政策，針對守護程序與系統軟體加以管制
      可設定政策如下：
      targeted：預設使用的政策，對大部分網路服務程序進行管制
      minimum：以targeted政策為基礎，僅對選定的網路服務程序進行管制
      mls：多層級安全保護，對所有程序進行管制，是最嚴格的政策
    status: automated
    rules:
      - selinux_policytype
      - var_selinux_policy_name=targeted
  - id: TWGCB-01-012-0186
    title: SELinux啟用狀態
    levels:
      - selinux
    notes: |-
      這項原則設定決定系統開機時是否啟用SELinux，以及啟用的模式
      模式選項如下：
      enforcing：強制模式，依據設定來限制檔案資源存取
      permissive：寬容模式，不限制檔案資源存取，但仍會依據設定檢查並記錄相關訊息
      disabled：停用模式，停用SELinux
      注意：建議先進行測試再啟用SELinux，並於啟用後確認各項系統服務可正常運作
    status: automated
    rules:
      - selinux_not_disabled
      - selinux_state
      - var_selinux_state=enforcing
  - id: TWGCB-01-012-0187
    title: 未受限程序
    levels:
      - selinux
    notes: |-
      這項原則設定決定是否允許存在未受限程序
      未受限程序在SELinux的「unconfined_service_t」區域中執行，幾乎擁有全部的存取權限
      若未受限程序被攻陷，SELinux將無法阻止攻擊者取得系統資源與資料
      注意：建議先進行測試再變更程序類型，並於啟用後確認各項系統服務可正常運作
    status: automated
    rules:
      - selinux_confinement_of_daemons
  - id: TWGCB-01-012-0188
    title: setroubleshoot套件
    levels:
      - selinux
    notes: |-
      這項原則設定決定是否移除setroubleshoot套件
      setroubleshoot為SELinux問題診斷套件，此服務會將SELinux執行時所產生包含設定錯誤、未授權存取等錯誤資訊通知給使用者，將可能暴露機敏資訊，或遭使用者惡意變更SELinux設定
    status: automated
    rules:
      - package_setroubleshoot_removed
  - id: TWGCB-01-012-0189
    title: mcstrans套件
    levels:
      - selinux
    notes: |-
      這項原則設定決定是否使用mcstrans套件
      mcstrans(Multi category security translation service)套件主要用於將SELinux的多重類別安全性(MCS)標籤轉換為人類可讀的格式
      此套件非經常使用，移除mcstrans套件可減少系統被攻擊面
    status: automated
    rules:
      - package_mcstrans_removed
  - id: TWGCB-01-012-0190
    title: cron守護程序
    levels:
      - cron
    notes: |-
      這項原則設定決定是否啟用cron守護程序
      cron守護程序是Linux系統上基於時間的任務管理系統，可透過cron以排程方式於固定時間、日期及間隔執行任務
      啟用cron守護程序，以執行包含安全監控等系統維護作業
    status: automated
    rules:
      - package_cron_installed
      - service_crond_enabled
  - id: TWGCB-01-012-0191
    title: /etc/crontab檔案所有權
    levels:
      - cron
    notes: |-
      這項原則設定決定/etc/crontab檔案擁有者與群組
      cron使用/etc/crontab檔案來控制自身的作業，檔案中包含cron所運行的系統作業資訊
      為/etc/crontab檔案設定擁有者與群組，以保護檔案避免遭未經授權存取，進而嘗試提升權限
    status: automated
    rules:
      - file_groupowner_crontab
      - file_owner_crontab
  - id: TWGCB-01-012-0192
    title: /etc/crontab檔案權限
    levels:
      - cron
    notes: |-
      這項原則設定決定是否設定/etc/crontab檔案權限
      cron使用/etc/crontab檔案來控制自身的作業，檔案中包含cron所運行的系統作業資訊
      為/etc/crontab檔案設定權限，以保護檔案避免遭未經授權存取，進而嘗試提升權限
    status: automated
    rules:
      - file_permissions_crontab
  - id: TWGCB-01-012-0193
    title: /etc/cron.hourly目錄所有權
    levels:
      - cron
    notes: |-
      這項原則設定決定/etc/cron.hourly目錄擁有者與群組
      /etc/cron.hourly目錄包含cron每小時需要執行的作業資訊，此目錄下的檔案無法使用crontab命令進行操作，而是由系統管理者使用編輯器進行編輯
      為/etc/cron.hourly目錄設定擁有者與群組，限制一般使用者存取權限，以避免藉此進而提升權限
    status: automated
    rules:
      - file_groupowner_cron_hourly
      - file_owner_cron_hourly
  - id: TWGCB-01-012-0194
    title: /etc/cron.hourly目錄權限
    levels:
      - cron
    notes: |-
      這項原則設定決定是否設定/etc/cron.hourly目錄權限
      /etc/cron.hourly目錄包含cron每小時需要執行的作業資訊，此目錄下的檔案無法使用crontab命令進行操作，而是由系統管理者使用編輯器進行編輯
      為/etc/cron.hourly目錄設定權限，限制一般使用者存取權限，以避免藉此進而提升權限
    status: automated
    rules:
      - file_permissions_cron_daily
  - id: TWGCB-01-012-0195
    title: /etc/cron.daily目錄所有權
    levels:
      - cron
    notes: |-
      這項原則設定決定/etc/cron.daily目錄擁有者與群組
      /etc/cron.daily目錄包含cron每日需要執行的作業資訊，此目錄下的檔案無法使用crontab命令進行操作，而是由系統管理者使用編輯器進行編輯
      為/etc/cron.daily目錄設定擁有者與群組，限制一般使用者存取權限，以避免藉此進而提升權限
    status: automated
    rules:
      - file_groupowner_cron_daily
      - file_owner_cron_daily
  - id: TWGCB-01-012-0196
    title: /etc/cron.daily目錄權限
    levels:
      - cron
    notes: |-
      這項原則設定決定是否設定/etc/cron.daily目錄權限
      /etc/cron.daily目錄包含cron每日需要執行的作業資訊，此目錄下的檔案無法使用crontab命令進行操作，而是由系統管理者使用編輯器進行編輯
      為/etc/cron.daily目錄設定權限，限制一般使用者存取權限，以避免藉此進而提升權限
    status: automated
    rules:
      - file_permissions_cron_daily
  - id: TWGCB-01-012-0197
    title: /etc/cron.weekly目錄所有權
    levels:
      - cron
    notes: |-
      這項原則設定決定/etc/cron.weekly目錄擁有者與群組
      /etc/cron.weekly目錄包含cron每週需要執行的作業資訊，此目錄下的檔案無法使用crontab命令進行操作，而是由系統管理者使用編輯器進行編輯
      為/etc/cron.weekly目錄設定擁有者與群組，限制一般使用者存取權限，以避免藉此進而提升權限
    status: automated
    rules:
      - file_groupowner_cron_weekly
      - file_owner_cron_weekly
  - id: TWGCB-01-012-0198
    title: /etc/cron.weekly目錄權限
    levels:
      - cron
    notes: |-
      這項原則設定決定是否設定/etc/cron.weekly目錄權限
      /etc/cron.weekly目錄包含cron每週需要執行的作業資訊，此目錄下的檔案無法使用crontab命令進行操作，而是由系統管理者使用編輯器進行編輯
      為/etc/cron.weekly目錄設定權限，限制一般使用者存取權限，以避免藉此進而提升權限
    status: automated
    rules:
      - file_permissions_cron_weekly
  - id: TWGCB-01-012-0199
    title: /etc/cron.monthly目錄所有權
    levels:
      - cron
    notes: |-
      這項原則設定決定/etc/cron.monthly目錄擁有者與群組
      /etc/cron.monthly目錄包含cron每月需要執行的作業資訊，此目錄下的檔案無法使用crontab命令進行操作，而是由系統管理者使用編輯器進行編輯
      為/etc/cron.monthly目錄設定擁有者與群組，限制一般使用者存取權限，以避免藉此進而提升權限
    status: automated
    rules:
      - file_groupowner_cron_monthly
      - file_owner_cron_monthly
  - id: TWGCB-01-012-0200
    title: /etc/cron.monthly目錄權限
    levels:
      - cron
    notes: |-
      這項原則設定決定是否設定/etc/cron.monthly目錄權限
      /etc/cron.monthly目錄包含cron每月需要執行的作業資訊，此目錄下的檔案無法使用crontab命令進行操作，而是由系統管理者使用編輯器進行編輯
      為/etc/cron.monthly目錄設定權限，限制一般使用者存取權限，以避免藉此進而提升權限
    status: automated
    rules:
      - file_permissions_cron_monthly
  - id: TWGCB-01-012-0201
    title: /etc/cron.d目錄所有權
    levels:
      - cron
    notes: |-
      這項原則設定決定/etc/cron.d目錄擁有者與群組
      /etc/cron.d目錄包含cron作業資訊，其執行方式與/etc/crontab中的每小時、每日、每週及每月的作業相似，主要使用於需要對執行時間做更精細控制之場合。此目錄下的檔案無法使用crontab命令進行操作，而是由系統管理者使用編輯器進行編輯
      為/etc/cron.d目錄設定擁有者與群組，限制一般使用者存取權限，以避免藉此進而提升權限
    status: automated
    rules:
      - file_groupowner_cron_d
      - file_owner_cron_d
  - id: TWGCB-01-012-0202
    title: /etc/cron.d目錄權限
    levels:
      - cron
    notes: |-
      這項原則設定決定是否設定/etc/cron.d目錄權限
      /etc/cron.d目錄包含cron作業資訊，其執行方式與/etc/crontab中的每小時、每日、每週及每月的作業相似，主要使用於需要對執行時間做更精細控制之場合。此目錄下的檔案無法使用crontab命令進行操作，而是由系統管理者使用編輯器進行編輯
      為/etc/cron.d目錄設定權限，限制一般使用者存取權限，以避免藉此進而提升權限
    status: automated
    rules:
      - file_permissions_cron_d
  - id: TWGCB-01-012-0203
    title: at.allow與cron.allow檔案所有權
    levels:
      - cron
    notes: |-
      這項原則設定決定at.allow與cron.allow檔案所有權
      刪除/etc/at.deny與/etc/cron.deny檔案的拒絕清單，並設定/etc/cron.allow與/etc/at.allow檔案所有權，限制僅系統管理者可授權誰可以使用at與cron建立排程工作
    status: automated
    rules:
      - file_groupowner_at_allow
      - file_groupowner_cron_allow
      - file_owner_at_allow
      - file_owner_cron_allow
  - id: TWGCB-01-012-0204
    title: at.allow與cron.allow檔案權限
    levels:
      - cron
    notes: |-
      這項原則設定決定是否設定at.allow與cron.allow檔案權限
      刪除/etc/at.deny與/etc/cron.deny檔案的拒絕清單，並設定/etc/cron.allow與/etc/at.allow檔案權限，限制僅系統管理者可授權誰可以使用at與cron建立排程工作
    status: automated
    rules:
      - file_permissions_at_allow
      - file_permissions_cron_allow
  - id: TWGCB-01-012-0205
    title: cron日誌記錄功能
    levels:
      - cron
    notes: |-
      這項原則設定決定是否啟用cron日誌記錄功能
      啟用cron日誌記錄功能時，可查看cron作業之成功或失敗執行紀錄，供系統管理者及早發現未經授權存取與惡意使用cron工具之行為
    status: automated
    rules:
      - rsyslog_cron_logging
  - id: TWGCB-01-012-0206
    title: 可設定通行碼次數
    levels:
      - accounts
    notes: |-
      這項原則設定決定重新設定通行碼時，若通行碼強度未達到系統要求，可以連續輸入通行碼之次數
      若使用PAM模組管理通行碼，pam_pwquality.so將會檢驗通行碼相關規則，例如通行碼長度、通行碼使用字元及通行碼複雜度等，高強度通行碼可降低系統遭攻擊者進行字典檔查詢或暴力破解等通行碼攻擊之影響
      retry=3：使用者有3次機會設定符合規定之通行碼，若超過3次無法變更成功，則會回應錯誤
    status: automated
    rules:
      - accounts_password_pam_retry
      - var_password_pam_retry=3
    related_rules:
      - package_pam_pwquality_installed
  - id: TWGCB-01-012-0207
    title: 強制root通行碼須符合通行碼規則
    levels:
      - accounts
    notes: |-
      這項原則設定決定是否強制root帳號之通行碼須符合通行碼規則
      若使用PAM模組管理通行碼，pam_pwquality.so將會檢驗通行碼相關規則，例如通行碼長度、通行碼使用字元及通行碼複雜度等，高強度通行碼可降低系統遭攻擊者進行字典檔查詢或暴力破解等通行碼攻擊之影響
      啟用root帳號通行碼檢查功能，以確保即使重新設定通行碼者為root帳號，亦須符合通行碼規則，以提高通行碼強度
      Enforce_for_root：強制root帳號之通行碼須符合通行碼規則
    status: automated
    rules:
      - accounts_password_pam_enforce_root
    related_rules:
      - package_pam_pwquality_installed
  - id: TWGCB-01-012-0208
    title: 通行碼最小長度
    levels:
      - accounts
    notes: |-
      這項原則設定決定使用者帳號之通行碼可包含之最少字元數
      若使用PAM模組管理通行碼，pam_pwquality.so將會檢驗通行碼相關規則，例如通行碼長度、通行碼使用字元及通行碼複雜度等，高強度通行碼可降低系統遭攻擊者進行字典檔查詢或暴力破解等通行碼攻擊之影響
      minlen = 12：表示通行碼至少包含12個字元
    status: automated
    rules:
      - accounts_password_pam_minlen
      - accounts_password_minlen_login_defs
      - var_password_pam_minlen=12
      - var_accounts_password_minlen_login_defs=12
    related_rules:
      - package_pam_pwquality_installed
  - id: TWGCB-01-012-0209
    title: 通行碼必須至少包含字元類別數量
    levels:
      - accounts
    notes: |-
      這項原則設定決定使用者帳號之通行碼至少包含幾種類別之字元
      設定使用者帳號之通行碼至少包含4種類別字元(數字、大寫、小寫及特殊字元)，以提高通行碼複雜度與強度，降低系統遭攻擊者進行字典檔查詢或暴力破解等通行碼攻擊之影響
      minclass = 4：表示通行碼至少要有4種類別字元
    status: automated
    rules:
      - accounts_password_pam_minclass
      - var_password_pam_minclass=4
    related_rules:
      - package_pam_pwquality_installed
  - id: TWGCB-01-012-0210
    title: 通行碼必須至少包含數字個數
    levels:
      - accounts
    notes: |-
      這項原則設定決定使用者帳號之通行碼至少包含幾個數字
      當dcredit大於或等於0時，代表通行碼每出現1個數字時，Length credit加1(最多加到與dcredit相同)
      當dcredit小於0時，代表通行碼必須至少包含之「數字」個數
      dcredit=-1：表示通行碼至少包含1個數字
    status: automated
    rules:
      - accounts_password_pam_dcredit
      - var_password_pam_dcredit=1
    related_rules:
      - package_pam_pwquality_installed
  - id: TWGCB-01-012-0211
    title: 通行碼必須至少包含大寫字母個數
    levels:
      - accounts
    notes: |-
      這項原則設定決定使用者帳號之通行碼至少包含幾個大寫字母
      當ucredit大於或等於0時，代表通行碼每出現1個大寫字母時，Length credit加1(最多加到與ucredit相同)
      當ucredit小於0時，代表通行碼必須至少包含之「大寫字母」個數
      ucredit=-1：表示通行碼至少包含1個大寫字母
    status: automated
    rules:
      - accounts_password_pam_ucredit
      - var_password_pam_ucredit=1
    related_rules:
      - package_pam_pwquality_installed
  - id: TWGCB-01-012-0212
    title: 通行碼必須至少包含小寫字母個數
    levels:
      - accounts
    notes: |-
      這項原則設定決定使用者帳號之通行碼至少包含幾個小寫字母
      當lcredit大於或等於0時，代表通行碼每出現1個小寫字母時，Length credit加1(最多加到與lcredit相同)
      當lcredit小於0時，代表通行碼必須至少包含之「小寫字母」個數
      lcredit=-1：表示通行碼至少包含1個小寫字母
    status: automated
    rules:
      - accounts_password_pam_lcredit
      - var_password_pam_lcredit=1
    related_rules:
      - package_pam_pwquality_installed
  - id: TWGCB-01-012-0213
    title: 通行碼必須至少包含特殊字元個數
    levels:
      - accounts
    notes: |-
      這項原則設定決定使用者帳號之通行碼至少包含幾個特殊字元
      當ocredit大於或等於0時，代表通行碼每出現1個小寫字母時，Length credit加1(最多加到與ocredit相同)
      當ocredit小於0時，代表通行碼必須至少包含之「特殊字元」個數
      ocredit=-1：表示通行碼至少包含1個特殊字元
    status: automated
    rules:
      - accounts_password_pam_ocredit
      - var_password_pam_ocredit=1
    related_rules:
      - package_pam_pwquality_installed
  - id: TWGCB-01-012-0214
    title: 新通行碼與舊通行碼最少相異字元數
    levels:
      - accounts
    notes: |-
      這項原則設定決定使用者帳號之新通行碼內必須有幾個字元與舊通行碼不同
      設定新通行碼與舊通行碼之相異字元數，以避免使用者長期使用相同或相似之通行碼
      difok =3：表示新通行碼必須有3個字元與舊通行碼不同
    status: automated
    rules:
      - accounts_password_pam_difok
      - var_password_pam_difok=3
    related_rules:
      - package_pam_pwquality_installed
  - id: TWGCB-01-012-0215
    title: 同一類別字元可連續使用個數
    levels:
      - accounts
    notes: |-
      這項原則設定決定使用者帳號之通行碼最多允許同一類別字元可連續使用個數
      若使用PAM模組管理通行碼，pam_pwquality.so將會檢驗通行碼相關規則，例如通行碼長度、通行碼使用字元及通行碼複雜度等，高強度通行碼可降低系統遭攻擊者進行字典檔查詢或暴力破解等通行碼攻擊之影響
      maxclassrepeat = 4：表示通行碼最多允許連續4個同一類別之字元
    status: automated
    rules:
      - accounts_password_pam_maxclassrepeat
      - var_password_pam_maxclassrepeat=4
    related_rules:
      - package_pam_pwquality_installed
  - id: TWGCB-01-012-0216
    title: 相同字元可連續使用個數
    levels:
      - accounts
    notes: |-
      這項原則設定決定使用者帳號之通行碼最多允許可連續使用幾個相同字元
      若使用PAM模組管理通行碼，pam_pwquality.so將會檢驗通行碼相關規則，例如通行碼長度、通行碼使用字元及通行碼複雜度等，高強度通行碼可降低系統遭攻擊者進行字典檔查詢或暴力破解等通行碼攻擊之影響
      maxrepeat = 3：表示通行碼最多允許3個連續相同字元
    status: automated
    rules:
      - accounts_password_pam_maxrepeat
      - var_password_pam_maxrepeat=3
    related_rules:
      - package_pam_pwquality_installed
  - id: TWGCB-01-012-0217
    title: 必須禁止使用字典檔單字做為通行碼
    levels:
      - accounts
    notes: |-
      這項原則設定決定是否禁止使用字典檔單字做為使用者帳號之通行碼
      若使用PAM模組管理通行碼，pam_pwquality.so將會檢驗通行碼相關規則，例如通行碼長度、通行碼使用字元及通行碼複雜度等，高強度通行碼可降低系統遭攻擊者進行字典檔查詢或暴力破解等通行碼攻擊之影響
      dictcheck=1：表示通行碼不可為字典檔單字
    status: automated
    rules:
      - accounts_password_pam_dictcheck
    related_rules:
      - package_pam_pwquality_installed
  - id: TWGCB-01-012-0218
    title: 帳戶鎖定閾值
    levels:
      - accounts
    notes: |-
      這項原則設定決定使用者帳號被鎖定之嘗試登入失敗次數，以降低通行碼暴力攻擊之影響
      deny=5：使用者帳號被鎖定嘗試登入失敗最多5次
    status: automated
    rules:
      - accounts_passwords_pam_faillock_deny
      - var_accounts_passwords_pam_faillock_deny=5
  - id: TWGCB-01-012-0219
    title: 帳戶鎖定時間
    levels:
      - accounts
    notes: |-
      這項原則設定決定使用者帳號被鎖定後之帳號解鎖時間，以降低通行碼暴力攻擊之影響
      unlock_time=900：決定鎖定帳號後，必須經過900秒才能解除鎖定
      若解除鎖定之時間未到，可由系統管理者執行下列指令逕行解除鎖定：
      #faillock --user (使用者帳號名稱) --reset
    status: automated
    rules:
      - accounts_passwords_pam_faillock_unlock_time
      - var_accounts_passwords_pam_faillock_unlock_time=900
  - id: TWGCB-01-012-0220
    title: 強制執行通行碼歷程記錄
    levels:
      - accounts
    notes: |-
      這項原則設定決定記錄幾個使用者最近使用之舊通行碼，並限制新通行碼不能與此類舊通行碼重複
      藉由限制使用者不能持續重複使用舊通行碼，令攻擊者難以猜測通行碼以提升安全性
    status: automated
    rules:
      - accounts_password_pam_unix_remember
      - var_password_pam_remember=3
  - id: TWGCB-01-012-0221
    title: 顯示登入失敗次數與日期
    levels:
      - accounts
    notes: |-
      這項原則設定決定是否在使用者登入時顯示登入失敗次數，以及最近一次登入失敗之日期
      顯示使用者登入失敗與日期，有助於使用者及早發現帳號遭冒用之情形
    status: automated
    rules:
      - display_login_attempts
  - id: TWGCB-01-012-0222
    title: 通行碼雜湊演算法
    levels:
      - accounts
    notes: |-
      這項原則設定決定系統所採用之通行碼雜湊演算法
      SHA512相對於MD5提供更強之雜湊演算法，可提高攻擊者破解通行碼難度，為系統提供多一層安全防護
    status: automated
    rules:
      - set_password_hashing_algorithm_libuserconf
      - set_password_hashing_algorithm_logindefs
      - set_password_hashing_algorithm_passwordauth
      - set_password_hashing_algorithm_systemauth
      - var_password_hashing_algorithm=SHA512
      - var_password_hashing_algorithm_pam=sha512
  - id: TWGCB-01-012-0223
    title: 通行碼最短使用期限
    levels:
      - accounts
    notes: |-
      這項原則設定決定在使用者變更通行碼之前，通行碼必須使用之期限(天數)。設為0代表可隨時變更通行碼，設為-1代表停用此原則
      設定通行碼最短使用期限為1天，以避免使用者重複使用相同通行碼
    status: automated
    rules:
      - accounts_minimum_age_login_defs
      - var_accounts_minimum_age_login_defs=1
  - id: TWGCB-01-012-0224
    title: 通行碼到期前提醒使用者變更通行碼
    levels:
      - accounts
    notes: |-
      這項原則設定決定在使用者通行碼即將到期時，要提前多久(天數)提醒使用者進行通行碼變更
      設定通行碼到期前14天提醒使用者，預先提供通行碼即將到期之警告，讓使用者有時間思考安全通行碼
    status: automated
    rules:
      - accounts_password_warn_age_login_defs
      - var_accounts_password_warn_age_login_defs=14
  - id: TWGCB-01-012-0225
    title: 通行碼最長使用期限
    levels:
      - accounts
    notes: |-
      這項原則設定決定系統要求使用者變更通行碼之前，通行碼可以使用之期限(天數)。設為-1代表停用此原則
      設定通行碼最長使用期限為90天，提高通行碼更換頻率，提高攻擊者破解通行碼難度
    status: automated
    rules:
      - accounts_maximum_age_login_defs
      - var_accounts_maximum_age_login_defs=90
  - id: TWGCB-01-012-0226
    title: 通行碼到期後，帳號停用前之天數
    levels:
      - accounts
    notes: |-
      這項原則設定決定使用者帳號於通行碼到期後，若超過設定天數則停用帳號
      設定通行碼到期後，超過30天即停用帳號，避免未使用帳號對系統構成威脅
    status: automated
    rules:
      - account_disable_post_pw_expiration
      - accounts_set_post_pw_existing
      - var_account_disable_post_pw_expiration=30
  - id: TWGCB-01-012-0227
    title: 登入嘗試失敗之延遲時間
    levels:
      - accounts
    notes: |-
      這項原則設定決定在使用者登入嘗試失敗後須延遲多久時間(秒)，才允許再次嘗試登入系統
      設定登入嘗試失敗之延遲時間，可減緩自動猜測通行碼攻擊速度，提高通行碼猜測難度
    status: automated
    rules:
      - accounts_logon_fail_delay
      - var_accounts_fail_delay=4
  - id: TWGCB-01-012-0228
    title: 新使用者帳號預設建立使用者家目錄
    levels:
      - accounts
    notes: |-
      這項原則設定決定當系統新增新使用者帳號時，是否為該帳號建立使用者家目錄
      為新增使用者帳號預設建立使用者家目錄，供使用者存放環境設定與個人檔案
    status: automated
    rules:
      - accounts_have_homedir_login_defs
  - id: TWGCB-01-012-0229
    title: 要求使用者必須經過身分鑑別才能提升權限
    levels:
      - accounts
    notes: |-
      這項原則設定決定是否要求使用者必須經過身分鑑別，才能使用sudo提升權限或更換角色
      設定使用sudo提權時必須經過身分鑑別，以避免遭使用者存取未被授權之檔案或服務
    status: automated
    rules:
      - sudo_remove_nopasswd
  - id: TWGCB-01-012-0230
    title: 限制每個帳號可同時登入之數量
    levels:
      - accounts
    notes: |-
      這項原則設定決定是否限制每個帳號可同時登入之數量
      限制系統上每個帳號可同時登入之數量，有助於降低阻斷服務攻擊之風險
      注意：這項原則設定可能會影響系統服務之同時登入上限，啟用此項設定後，請確認各項系統服務正常運作
    status: automated
    rules:
      - accounts_max_concurrent_login_sessions
      - var_accounts_max_concurrent_login_sessions=10
  - id: TWGCB-01-012-0231
    title: kbd套件
    levels:
      - accounts
    notes: |-
      這項原則設定決定是否安裝kbd套件，套件提供vlock工具可用於鎖定使用者終端機螢幕
      安裝kbd套件後，即可使用vlock工具在終端機介面啟動螢幕鎖定機制，以防止資訊外洩或遭人惡意終止目前正在執行之作業
      輸入啟動終端機螢幕鎖定之使用者通行碼可解除鎖定狀態
    status: automated
    rules:
      - vlock_installed
  - id: TWGCB-01-012-0232
    title: 使用者會談鎖定
    levels:
      - accounts
    notes: |-
      這項原則設定決定是否設定使用者會談鎖定，以啟用螢幕保護裝置
      設定使用者會談鎖定，提供使用者需暫時離開系統之防護措施，必須重新進行身分鑑別才能解除鎖定登入系統
    status: automated
    rules:
      - dconf_gnome_screensaver_lock_enabled
  - id: TWGCB-01-012-0233
    title: GNOME使用者會談逾時時間
    levels:
      - accounts
    notes: |-
      這項原則設定決定是否設定GNOME使用者會談逾時時間，超過逾時時間系統將鎖定該會談
      設定使用者會談逾時時間，提供使用者離開系統而未登出之防護措施，必須重新進行身分鑑別才能解除鎖定登入系統
    status: automated
    rules:
      - dconf_gnome_screensaver_idle_delay
      - inactivity_timeout_value=15_minutes
  - id: TWGCB-01-012-0234
    title: 禁止GNOME使用者自動登入
    levels:
      - accounts
    notes: |-
      這項原則設定決定是否禁止GNOME使用者在圖形使用者介面下自動登入
      禁止GNOME使用者自動登入，以避免使用者無需身分鑑別即可存取系統資料，導致資料外洩或遭竄改設定
    status: automated
    rules:
      - gnome_gdm_disable_automatic_login
  - id: TWGCB-01-012-0235
    title: 系統帳號登入方式
    levels:
      - accounts
    notes: |-
      這項原則設定決定是否藉由設定nologin參數，以禁止系統帳號登入
      系統帳號是除了root外，UID小於1000之帳號，與一般使用者無關，是為了執行相關管理功能而存在於系統中
      針對系統帳號進行通行碼鎖定與設定無法登入之合法 shell(/sbin/nologin)，以提高攻擊者使用此類帳號進行攻擊之難度
      系統帳號雖無法使用bash或其他shell登入系統，但仍可使用系統資源提供服務
    status: automated
    rules:
      - no_shelllogin_for_systemaccounts
  - id: TWGCB-01-012-0236
    title: Bash shell閒置時登出時間
    levels:
      - accounts
    notes: |-
      這項原則設定決定Bash shell閒置超過多少秒後自動登出
      Bash目前是Linux之標準shell，Bash主要相容於sh，並且依據一些使用者需求而加強之shell版本
      當shell屬於前景程序時，才能自動從shell登出，例如使用vim編輯檔案並已閒置15分鐘，自動登出將不會發生
      設定Bash shell閒置逾時時間，可提供使用者離開系統而未鎖定螢幕之防護措施，避免其他使用者未經授權使用shell
    status: automated
    rules:
      - accounts_tmout
      - var_accounts_tmout=15_min
  - id: TWGCB-01-012-0237
    title: 防止修改圖形使用者介面(GUI)設定
    levels:
      - accounts
    notes: |-
      這項原則設定決定是否防止修改圖形使用者介面(GUI)設定
      使用者會談鎖定(Session Lock)機制，提供使用者需暫時離開系統之防護措施，必須重新進行身分鑑別才能解除鎖定登入系統
      防止使用者修改GUI介面設定，避免使用者變更系統之鎖定機制以保護系統安全
    status: manual
  - id: TWGCB-01-012-0238
    title: root帳號所屬群組
    levels:
      - accounts
    notes: |-
      這項原則設定決定是否檢查root帳號所屬群組
      usermod指令可用於指定root帳號所屬群組，這會影響root管理者所建立檔案之權限
      root帳號所屬群組使用GID 0，有助於防止一般使用者意外存取root帳號所擁有之檔案
    status: automated
    rules:
      - accounts_root_gid_zero
  - id: TWGCB-01-012-0239
    title: 所有使用者帳號之預設umask
    levels:
      - accounts
    notes: |-
      這項原則設定決定是否在/etc/profile中設定所有使用者帳號之預設umask，用以指定新建立檔案之預設權限
      umask設為027，表示使用者所建立之檔案，擁有者可讀取、寫入及執行，群組可讀取與執行，其他使用者無讀取、寫入及執行權限
      umask第1個位元代表擁有者，第2個位元代表群組，第3個位元代表其他使用者，設定值說明如下：
      0：可讀取、寫入及執行
      1：不可執行
      2：不可寫入
      3：不可寫入與執行
      4：不可讀取
      5：不可讀取與執行
      6：不可讀取與寫入
      7：不可讀取、寫入及執行
    status: automated
    rules:
      - accounts_umask_etc_bashrc
      - accounts_umask_etc_profile
      - var_accounts_user_umask=027
  - id: TWGCB-01-012-0240
    title: 在/etc/login.defs設定所有使用者之預設umask
    levels:
      - accounts
    notes: |-
      這項原則設定決定在/etc/login.defs設定所有使用者之預設umask，umask用以指定新建立之檔案或目錄之預設權限
      設定umask為027，表示使用者所建立之檔案，擁有者可讀取、寫入及執行，群組可讀取及執行，其他使用者無讀取、寫入及執行權限
      umask第1個位元代表擁有者，第2個位元代表群組，第3個位元代表其他使用者，設定值說明如下：
      0：可讀、寫及執行
      1：不可執行
      2：不可寫
      3：不可寫與執行
      4：不可讀
      5：不可讀與執行
      6：不可讀與寫
      7：不可讀、寫及執行
    status: automated
    rules:
      - accounts_umask_etc_login_defs
      - var_accounts_user_umask=027
  - id: TWGCB-01-012-0241
    title: 可使用su指令之群組
    levels:
      - accounts
    notes: |-
      這項原則設定決定是否設定wheel群組(所有系統管理者所屬群組)，並限制僅wheel群組內之使用者才能使用su指令
      su指令允許使用者以其他使用者身分執行指令或shell，預設情況下任何使用者皆可執行su指令，透過啟用/etc/pam.d/su檔案之pam_wheel.so設定，將僅允許wheel群組中之用戶執行su指令，有利於系統管理者控管使用者提升特權行為
    status: automated
    rules:
      - use_pam_wheel_for_su
  - id: TWGCB-01-012-0242
    title: firewalld防火牆套件
    levels:
      - firewalld
    notes: |-
      這項原則設定決定是否安裝firewalld防火牆套件
      藉由防火牆管理與設定，以保護系統安全
    status: automated
    rules:
      - package_firewalld_installed
  - id: TWGCB-01-012-0243
    title: firewalld服務
    levels:
      - firewalld
    notes: |-
      這項原則設定決定是否啟用firewalld服務
      firewalld為一款動態防火牆管理工具，加入了區域(zone)概念，且同時支援IPv4與IPv6環境，並提供介面讓服務程序或應用程式依需求直接新增防火牆規則
      建議啟用防火牆服務，以保護系統安全
    status: automated
    rules:
      - service_firewalld_enabled
  - id: TWGCB-01-012-0244
    title: iptables服務
    levels:
      - firewalld
    notes: |-
      這項原則設定決定是否啟用iptables與ip6tables服務
      iptables與ip6tables為Linux作業系統本機端防火牆，藉由控制Linux核心之netfilter模組，進行封包過濾與處理
      同時運行firewalld與iptables(或ip6tables)服務，可能因彼此間之規則衝突，導致系統運作異常或產生資安風險，因此在使用firewalld時，建議停用並遮蔽iptables與ip6tables服務
    status: manual
  - id: TWGCB-01-012-0245
    title: nftables服務
    levels:
      - firewalld
    notes: |-
      這項原則設定決定是否啟用nftables服務
      nftables為iptables後繼產品，屬於Linux核心子系統，提供對網路封包(Packets)、資料包(Datagram)及訊框(Frame)進行過濾與分類功能
      安裝firewalld套件時，具有相依性之nftables套件會一起安裝
      同時運行firewalld與nftables服務，可能因彼此間之規則衝突，導致系統運作異常或產生資安風險，因此在使用firewalld時，建議停用並遮蔽nftables服務
    status: automated
    rules:
      - service_nftables_disabled
  - id: TWGCB-01-012-0246
    title: firewalld防火牆預設區域
    levels:
      - firewalld
    notes: |-
      這項原則設定決定是否設定防火牆預設區域
      防火牆區域定義了網路連線、介面或來源位址綁定之信任等級，這是一對多關係，意謂著網路連線、介面或來源位址只是區域中的一部分，但一個區域可包含多個網路連線、介面或來源位址
      所有未明確分配給特定區域之網路連線、介面或來源位址，都將被歸至預設區域
      設定預設區域，可確保所有網路連線、介面或來源位址皆被納管，以保護系統安全
    status: automated
    rules:
      - set_firewalld_appropriate_zone
  - id: TWGCB-01-012-0247
    title: nftables服務
    levels:
      - firewalld
    notes: |-
      這項原則設定決定是否啟用nftables服務
      nftables為iptables後繼產品，屬於Linux核心子系統，提供對網路封包(Packets)、資料包(Datagram)及訊框(Frame)進行過濾與分類功能
      建議啟用防火牆服務，以保護系統安全
    status: automated
    rules:
      - service_nftables_enabled
    related_rules:
      - package_nftables_installed
  - id: TWGCB-01-012-0248
    title: firewalld服務
    levels:
      - firewalld
    notes: |-
      這項原則設定決定是否啟用firewalld服務
      firewalld(Dynamic Firewall Manager)為一款動態防火牆管理工具，加入了區域(zone)概念，且同時支援IPv4與IPv6環境，並提供介面讓服務程序或應用程式依需求直接新增防火牆規則
      同時運行firewalld與nftables服務，可能因彼此間之規則衝突，導致系統運作異常或產生資安風險，因此在使用nftables時，建議停用並遮蔽firewalld服務
    status: automated
    rules:
      - service_firewalld_disabled
  - id: TWGCB-01-012-0249
    title: 在nftables中建立表
    levels:
      - nftables
    notes: |-
      這項原則設定決定是否在nftables中建立至少1個表(Tables)
      nftables預設不存在表，表為鏈(Chains)的容器，必須建立表，後續才能建立與保存鏈
      每個表必須定義一個位址族(Address family)，位址族選項如下：
      ip：IPv4位址族，處理IPv4封包
      ip6：IPv6位址族，處理IPv6封包
      inet：IPv4/IPv6位址族，可同時處理IPv4/IPv6封包
      arp：ARP位址族，處理IPv4 ARP封包
      bridge：Bridge位址族，處理橋接封包
      netdev：Netdev位址族，處理入口封包
    status: automated
    rules:
      - set_nftables_table
      - var_nftables_family=inet
      - var_nftables_table=filter
  - id: TWGCB-01-012-0250
    title: 在nftables建立基本鏈
    levels:
      - nftables
    notes: |-
      這項原則設定決定是否在nftables建立至少1個基本鏈(Base chains)
      nftables預設不存在表，在nftables建立表後才能建立鏈，鏈為規則(Rules)的容器，必須建立鏈，後續才能建立與保存規則
      建立輸入(input)、轉發(forward)及輸出(output)之基本鏈，以使用nftables進行網路封包過濾
    status: automated
    rules:
      - set_nftables_base_chain
      - var_nftables_base_chain_hooks=chain_hooks
      - var_nftables_base_chain_names=chain_names
      - var_nftables_base_chain_policies=chain_policies
      - var_nftables_base_chain_priorities=chain_priorities
      - var_nftables_base_chain_types=chain_types
      - var_nftables_family=inet
      - var_nftables_table=filter
  - id: TWGCB-01-012-0251
    title: 在nftables設定回送流量規則
    levels:
      - nftables
    notes: |-
      這項原則設定決定是否在nftables設定回送流量(loopback traffic)規則
      設定回送介面接受回送網路流量，並設定其他介面拒絕回送網路(127.0.0.0/8與::1)的流量
      回送網路流量是同一台電腦中程序彼此之間通訊所產生之流量，對於系統的運作至關重要
      設定僅回送介面可接受回送網路流量，且所有其他介面都應忽略回送網路流量，以協助防止偽冒攻擊
    status: automated
    rules:
      - set_nftables_loopback_traffic
  - id: TWGCB-01-012-0252
    title: 在nftables建立預設拒絕規則
    levels:
      - nftables
    notes: |-
      這項原則設定決定是否在nftables建立預設拒絕規則
      所建立之預設規則，會套用在已通過其他規則並到達鏈尾端之封包，該規則可設為接受(accept)或丟棄(drop)
      將預設拒絕規則設為丟棄，將到達鏈尾端之封包丟棄，以防止惡意封包通過防火牆，進而影響系統安全
    status: automated
    rules:
      - nftables_ensure_default_deny_policy
  - id: TWGCB-01-012-0253
    title: 載入nftables規則
    levels:
      - nftables
    notes: |-
      這項原則設定決定是否設定開機即載入nftables規則，使得系統運作期間，所設定之規則皆發揮作用，以保護系統安全
      nftables服務藉由讀取/etc/sysconfig/nftables.conf設定檔所引入之路徑，以載入nftables規則集，nftables規則集包含輸入、轉發及輸出之基本鏈，以執行網路封包過濾
    status: automated
    rules:
      - nftables_rules_permanent
      - var_nftables_master_config_file=sysconfig
  - id: TWGCB-01-012-0254
    title: sshd守護程序
    levels:
      - ssh
    notes: |-
      這項原則設定決定是否啟用sshd守護程序
      sshd(Openssh Server程式)實作SSH(Secure Shell)協定，可在兩個主機之間提供安全加密通訊
      啟用sshd守護程序，以加密方式保護傳輸資訊，以防攻擊者藉由封包攔截取得明文機敏資訊
    status: automated
    rules:
      - package_openssh-server_installed
      - service_sshd_enabled
    related_rules:
      - firewalld_sshd_port_enabled
  - id: TWGCB-01-012-0255
    title: SSH協定版本
    levels:
      - ssh
    notes: |-
      這項原則設定決定使用何種SSH協定版本
      SSH支援兩種不同且不相容的協定，分別為SSH-1與SSH-2協定，SSH-1為SSH原始協定且存在安全問題，SSH-2協定為新版本，提供功能改進並增強安全性
      設定使用SSH-2協定，以提供系統更安全的SSH使用環境
    status: automated
    rules:
      - sshd_allow_only_protocol2
  - id: TWGCB-01-012-0256
    title: /etc/ssh/sshd_config檔案所有權
    levels:
      - ssh
    notes: |-
      這項原則設定決定/etc/ssh/sshd_config檔案擁有者與群組，/etc/ssh/sshd_config檔案包含sshd守護程序環境設定
      為/etc/ssh/sshd_config檔案設定擁有者與群組，限制一般使用者存取權限，以避免設定遭竄改
    status: automated
    rules:
      - file_groupowner_sshd_config
      - file_owner_sshd_config
  - id: TWGCB-01-012-0257
    title: /etc/ssh/sshd_config檔案權限
    levels:
      - ssh
    notes: |-
      這項原則設定決定是否設定/etc/ssh/sshd_config檔案權限，/etc/ssh/sshd_config檔案包含sshd守護程序環境設定
      為/etc/ssh/sshd_config檔案設定權限，限制一般使用者存取權限，以避免設定遭竄改
    status: automated
    rules:
      - file_permissions_sshd_config
  - id: TWGCB-01-012-0258
    title: 限制存取SSH
    levels:
      - ssh
    notes: |-
      這項原則設定決定是否啟用限制存取SSH功能
      /etc/ssh/sshd_config檔案可設定以下參數，以限制可透過SSH存取系統的使用者與群組：
      AllowUsers：由空格分隔的使用者名稱組成，設定允許登入的使用者
      AllowGroups：由空格分隔的群組名稱組成，設定允許登入的群組
      DenyUsers：由空格分隔的使用者名稱組成，設定拒絕登入的使用者
      DenyGroups：由空格分隔的群組名稱組成，設定拒絕登入的群組
      啟用限制存取SSH功能，有助於確保只有授權使用者才能透過SSH遠端存取系統
    status: automated
    rules:
      - sshd_limit_user_access
  - id: TWGCB-01-012-0259
    title: SSH主機私鑰檔案所有權
    levels:
      - ssh
    notes: |-
      這項原則設定決定SSH主機私鑰檔案擁有者與群組
      SSH主機私鑰是SSH協定中驗證主機所使用的加密金鑰，搭配公鑰與私鑰可鑑別使用者身分
      設定SSH主機私鑰檔案擁有者與群組，避免遭未經授權的使用者取得檔案，用以假冒主機對用戶端進行中間人攻擊
    status: automated
    rules:
      - file_groupownership_sshd_private_key
      - file_ownership_sshd_private_key
  - id: TWGCB-01-012-0260
    title: SSH主機私鑰檔案權限
    levels:
      - ssh
    notes: |-
      這項原則設定決定是否設定SSH主機私鑰檔案權限
      SSH主機私鑰是SSH協定中驗證主機所使用的加密金鑰，搭配公鑰與私鑰可鑑別使用者身分
      設定SSH主機私鑰檔案權限，避免遭未經授權的使用者取得檔案，用以假冒主機對用戶端進行中間人攻擊
    status: automated
    rules:
      - file_permissions_sshd_private_key
  - id: TWGCB-01-012-0261
    title: SSH主機公鑰檔案所有權
    levels:
      - ssh
    notes: |-
      這項原則設定決定SSH主機公鑰檔案擁有者與群組
      SSH主機公鑰是SSH協定中驗證主機所使用的加密金鑰，搭配公鑰與私鑰可鑑別使用者身分
      設定SSH主機公鑰檔案擁有者與群組，避免遭未經授權的使用者修改檔案，導致主機SSH服務無法正常運作
    status: automated
    rules:
      - file_groupownership_sshd_pub_key
      - file_ownership_sshd_pub_key
  - id: TWGCB-01-012-0262
    title: SSH主機公鑰檔案權限
    levels:
      - ssh
    notes: |-
      這項原則設定決定是否設定SSH主機公鑰檔案權限
      SSH主機公鑰是SSH協定中驗證主機所使用的加密金鑰，搭配公鑰與私鑰可鑑別使用者身分
      設定SSH主機公鑰檔案權限，避免遭未經授權的使用者修改檔案，導致主機SSH服務無法正常運作
    status: automated
    rules:
      - file_permissions_sshd_pub_key
  - id: TWGCB-01-012-0263
    title: SSH加密演算法
    levels:
      - ssh
    notes: |-
      這項原則設定決定SSH所採用之加密演算法
      Ciphers參數可設定SSH-2協定可使用的加密演算法，支援演算法包含3des-cbc、aes128-cbc、aes192-cbc、aes256-cbc、aes128-ctr、aes192-ctr、aes256-ctr、arcfour128、arcfour256、arcfour、blowfish-cbc及st128-cbc
      MACS參數可設定MAC(Message Authentication Codes)可使用的雜湊演算法
      KexAlgorithm參數可設定金鑰交換演算法
      設定SSH加密演算法，以加密方式保護傳輸資訊，以防攻擊者藉由封包攔截進而取得明文機敏資訊
    status: partial
    rules:
      - harden_sshd_ciphers_opensshserver_conf_crypto_policy
      - harden_sshd_macs_opensshserver_conf_crypto_policy
      - sshd_approved_ciphers=stig
      - sshd_approved_macs=stig
  - id: TWGCB-01-012-0264
    title: SSH日誌記錄等級
    levels:
      - ssh
    notes: |-
      這項原則設定決定SSH日誌記錄等級，在/etc/ssh/sshd_config檔案中，使用LogLevel參數可設定SSH日誌的記錄等級，選項依照紀錄詳細程度由上至下排序如下，QUIET等級為基本紀錄，DEBUG3等級將包含最詳細紀錄：
      QUIET
      FATAL
      ERROR
      INFO
      VERBOSE
      DEBUG
      DEBUG1
      DEBUG2
      DEBUG3
      INFO等級為記錄SSH使用者登入活動的基本級別，可用於確定特定使用者何時在系統上處於活動狀態
      VERBOSE等級為記錄登入與登出活動，以及用於登入的任何SSH金鑰指紋，可使用於管理SSH金鑰
    status: automated
    rules:
      - sshd_set_loglevel_info
  - id: TWGCB-01-012-0265
    title: SSH X11Forwarding功能
    levels:
      - ssh
    notes: |-
      這項原則設定決定SSH是否啟用X11Forwarding功能
      X11Forwarding功能用於與X11建立通道，以啟用遠端圖形介面連線
      設定X11Forwarding參數為no，以停用遠端圖形介面連線功能
      對於允許使用者登入的X11遠端伺服器而言，可能遭伺服器上其他使用者攻擊
    status: automated
    rules:
      - sshd_disable_x11_forwarding
  - id: TWGCB-01-012-0266
    title: SSH MaxAuthTries參數
    levels:
      - ssh
    notes: |-
      這項原則設定決定SSH是否設定MaxAuthTries參數
      MaxAuthTries參數用以指定每個連接允許的驗證登入失敗次數，當登入失敗次數達到一半時，錯誤訊息將會寫入日誌檔案，詳細說明登入失敗過程
      建議將MaxAuthTries參數設定為較小的值，以降低針對SSH伺服器成功進行暴力攻擊之風險
    status: automated
    rules:
      - sshd_set_max_auth_tries
      - sshd_max_auth_tries_value=4
  - id: TWGCB-01-012-0267
    title: SSH IgnoreRhosts參數
    levels:
      - ssh
    notes: |-
      這項原則設定決定SSH是否設定IgnoreRhosts參數
      IgnoreRhosts參數指定在RhostsRSAAuthentication或HostbasedAuthentication鑑別過程中，將不使用.rhosts與.shosts檔案
      設定IgnoreRhosts參數為yes，強制使用者在使用SSH進行身分鑑別時須輸入通行碼
    status: automated
    rules:
      - sshd_disable_rhosts
  - id: TWGCB-01-012-0268
    title: SSH HostbasedAuthentication參數
    levels:
      - ssh
    notes: |-
      這項原則設定決定SSH是否設定HostbasedAuthentication參數，以指定是否使用基於主機之身分鑑別方式
      此參數僅適用於SSH-2協定
      基於主機的身分鑑別方式較不安全，建議停用
    status: automated
    rules:
      - disable_host_auth
  - id: TWGCB-01-012-0269
    title: SSH PermitRootLogin參數
    levels:
      - ssh
    notes: |-
      這項原則設定決定SSH是否設定PermitRootLogin參數，用以決定root帳號是否可使用SSH進行登入
      禁止root帳號使用SSH進行登入，改請系統管理者使用其個人帳號進行登入，再透過sudo或su指令提升權限為root，以降低系統風險
    status: automated
    rules:
      - sshd_disable_root_login
  - id: TWGCB-01-012-0270
    title: SSH PermitEmptyPasswords參數
    levels:
      - ssh
    notes: |-
      這項原則設定決定SSH是否設定PermitEmptyPasswords參數，用以指定SSH伺服器是否允許使用空通行碼帳號登入系統
      禁止空通行碼帳號使用SSH進行遠端存取，以降低未經授權存取系統之風險
    status: automated
    rules:
      - sshd_disable_empty_passwords
  - id: TWGCB-01-012-0271
    title: SSH PermitUserEnvironment參數
    levels:
      - ssh
    notes: |-
      這項原則設定決定SSH是否設定PermitUserEnvironment參數
      PermitUserEnvironment參數決定是否允許使用者可藉由SSH守護程序變更環境設定
      禁止使用者藉由SSH守護程序變更環境設定，以避免使用者得以繞過系統存取限制
    status: automated
    rules:
      - sshd_do_not_permit_user_env
  - id: TWGCB-01-012-0272
    title: SSH逾時時間
    levels:
      - ssh
    notes: |-
      這項原則設定決定是否設定SSH逾時時間
      ClientAliveInterval與ClientAliveCountMax參數可控制SSH連線逾時時間
      設定ClientAliveInterval參數後，在指定的時間內沒有任何活動將中斷SSH連線
      設定ClientAliveCountMax參數後，SSH守護程序將在每個ClientAliveInterval指定時間到達時，向用戶端發送訊息，若發送訊息次數到達該參數設定值時，用戶端都沒有回應，則中斷SSH連線
      舉例若ClientAliveInterval設為15秒，ClientAliveCountMax設為3時，用戶端若連續45秒都沒有回應，則中斷SSH連線
    status: automated
    rules:
      - sshd_set_idle_timeout
      - sshd_set_keepalive_0
      - sshd_idle_timeout_value=10_minutes
  - id: TWGCB-01-012-0273
    title: SSH LoginGraceTime參數
    levels:
      - ssh
    notes: |-
      這項原則設定決定SSH是否設定LoginGraceTime參數，用以限定當使用者連上SSH伺服器後，多少時間內若未成功登入，則中斷SSH連線
      設定登入逾時時間(單位為秒)，以避免未經授權使用者長久占據連線資源，導致其他使用者無法連線
    status: automated
    rules:
      - sshd_set_login_grace_time
      - var_sshd_set_login_grace_time=60
  - id: TWGCB-01-012-0274
    title: SSH UsePAM參數
    levels:
      - ssh
    notes: |-
      這項原則設定決定SSH是否啟用PAM(Pluggable Authentication Module，啟用插入式鑑別模組) 鑑別
      啟用PAM身分鑑別可提升系統鑑別功能與安全性
    status: automated
    rules:
      - sshd_enable_pam
  - id: TWGCB-01-012-0275
    title: SSH AllowTcpForwarding參數
    levels:
      - ssh
    notes: |-
      這項原則設定決定SSH是否設定AllowTcpForwarding參數
      AllowTcpForwarding參數用於設定SSH埠轉發(port forwarding)功能，將應用程序埠從用戶端隧道傳輸到伺服器，或將伺服器傳輸到用戶端
      停用SSH埠轉發功能，避免攻擊者或惡意程式利用SSH隱藏未經授權連線，或將竊取資料傳出
    status: automated
    rules:
      - sshd_disable_tcp_forwarding
  - id: TWGCB-01-012-0276
    title: SSH MaxStartups參數
    levels:
      - ssh
    notes: |-
      這項原則設定決定SSH是否設定MaxStartups參數，用以指定SSH守護程序同一時間可接受未經身分鑑別連線之最大數量
      限制同一時間可接受之未經身分鑑別連線數量，以避免未經授權使用者長久占據連線資源，導致其他使用者無法連線
    status: automated
    rules:
      - sshd_set_maxstartups
      - var_sshd_set_maxstartups=10:30:60
  - id: TWGCB-01-012-0277
    title: SSH MaxSessions參數
    levels:
      - ssh
    notes: |-
      這項原則設定決定SSH是否設定MaxSessions參數，用以指定每個網路連線允許的最大會談數
      限制每個網路連線允許的最大會談數，以保護系統避免由於同時間建立大量連線，而導致系統無法繼續提供服務
    status: automated
    rules:
      - sshd_set_max_sessions
      - var_sshd_max_sessions=4
  - id: TWGCB-01-012-0278
    title: SSH StrictModes參數
    levels:
      - ssh
    notes: |-
      這項原則設定決定SSH是否設定StrictModes參數，用以指定SSH守護程序在接受登入之前，是否檢查使用者家目錄與檔案之所有權與權限
      設定SSH守護程序檢查使用者家目錄與檔案之所有權與權限，以避免使用者目錄或檔案具有全域寫入權限，而導致遭竄改設定
    status: automated
    rules:
      - sshd_enable_strictmodes
  - id: TWGCB-01-012-0279
    title: SSH Compression參數
    levels:
      - ssh
    notes: |-
      這項原則設定決定SSH是否設定Compression參數，用以指定在使用者成功認證之前是否支援壓縮
      設定SSH守護程序在使用者通過身分鑑別前不能執行壓縮，避免因壓縮軟體漏洞而導致系統遭受攻擊
    status: automated
    rules:
      - sshd_disable_compression
  - id: TWGCB-01-012-0280
    title: SSH IgnoreUserKnownHosts參數
    levels:
      - ssh
    notes: |-
      這項原則設定決定SSH是否設定IgnoreUserKnownHosts參數，用以指定在RhostsRSAAuthentication或HostbasedAuthentication鑑別過程中，不使用已知主機之身分鑑別
      不使用已知主機之身分鑑別，以強制使用者在使用SSH遠端登入時須輸入通行碼
    status: automated
    rules:
      - sshd_disable_user_known_hosts
  - id: TWGCB-01-012-0281
    title: SSH PrintLastLog參數
    levels:
      - ssh
    notes: |-
      這項原則設定決定SSH是否設定PrintLastLog參數，用以指定當使用者登入系統時，SSH守護程序是否顯示上次使用者登入之日期與時間
      顯示使用者上次以SSH登入之日期與時間，有助於使用者及早發現帳號被盜用之情形
    status: automated
    rules:
      - sshd_print_last_log
  - id: TWGCB-01-012-0282
    title: shosts.equiv檔案
    levels:
      - ssh
    notes: |-
      這項原則設定決定是否移除shosts.equiv檔案
      當使用者進行SSH連線所使用電腦之名稱已經列在shosts.equiv檔案中時，若兩端的使用者名稱相同，則立即允許該使用者登入，此種基於主機之身分鑑別方式無需使用者輸入通行碼，容易遭偽冒身分
      移除shosts.equiv檔案，以強化使用者登入身分鑑別機制
    status: automated
    rules:
      - no_host_based_files
  - id: TWGCB-01-012-0283
    title: .shosts檔案
    levels:
      - ssh
    notes: |-
      這項原則設定決定是否移除「.shosts」檔案
      「.shosts」檔案用於設定SSH為單一使用者或使用基於主機之身分鑑別方式，因登入過程中無需使用者輸入通行碼，容易遭偽冒身分
      移除「.shosts」檔案，以強化使用者登入身分鑑別機制
    status: automated
    rules:
      - no_user_host_based_files
  - id: TWGCB-01-012-0284
    title: 覆寫全系統加密原則
    levels:
      - ssh
    notes: |-
      這項原則設定決定是否覆寫全系統加密原則，在SSH系統可設為覆寫或不使用全系統加密原則
      設定SSH系統停用覆寫全系統加密原則，以避免SSH使用到安全強度較低之加密演算法
    status: automated
    rules:
      - configure_ssh_crypto_policy
