documentation_complete: true

title: 'Verify that Shared Library Files are group owned by root or a system account'

description: |-
    System commands files are stored in the following directories by default:
    <pre>/lib
    /lib64
    /usr/lib
    /usr/lib64
    </pre>
    Kernel modules, which can be added to the kernel during runtime, are also
    stored in <tt>/lib/modules</tt>. All files in these directories should be
    owned by the <tt>root</tt> group, or a system account.
    If the directory, or any file in these directories, is found to be owned
    by a group other than root or a a system account correct its ownership
    with the following command:
    <pre>$ sudo chgrp root <i>FILE</i></pre>

rationale: |-
    Files from shared library directories are loaded into the address
    space of processes (including privileged ones) or of the kernel itself at
    runtime. Proper group ownership is necessary to protect the integrity of the
    system.

severity: medium

ocil_clause: 'any system wide shared library file is not group-owned by a required system account'

ocil: |-
    Verify the system-wide shared library files are group owned by "root" with the following command:

    $ sudo find -L /lib /lib64 /usr/lib /usr/lib64 ! -group root -exec ls -l {} \;

template:
    name: file_groupowner
    vars:
        filepath:
            - /lib/
            - /lib64/
            - /usr/lib/
            - /usr/lib64/
        recursive: 'true'
        file_regex: ^.*$
        gid_or_name: '0'

fixtext: |-
    Configure the system-wide shared library files (/lib, /lib64, /usr/lib and /usr/lib64) to be protected from unauthorized access.

    Run the following command, replacing "[FILE]" with any system command file not group-owned by "root" or a required system account.

    $ sudo chgrp root [FILE]

srg_requirement:
    {{{ full_name }}} library files must be group-owned by root or a system account.
